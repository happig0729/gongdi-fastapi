2025-06-08 09:44:09,441 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:44:10,144 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:44:10,471 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:44:10,943 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:44:11,316 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:44:26,597 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:44:26,776 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:44:27,103 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:44:27,323 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:44:37,161 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:45:02,416 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:45:46,544 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '时间', 'tools': [{}]}
2025-06-08 09:45:46,545 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:45:46,547 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: 时间
2025-06-08 09:45:46,548 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:45:46,548 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '时间'}]
2025-06-08 09:45:46,549 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:45:46,550 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:45:46,552 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:45:46,553 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 09:45:46,676 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '时间'}]}}
2025-06-08 09:45:46,685 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 09:45:48,981 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 09:45:48,983 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'tool_calls', 'message': {'role': 'assistant', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_e00f4efa187e4e88b8166e', 'type': 'function'}], 'content': ''}}]}, 'usage': {'total_tokens': 235, 'output_tokens': 13, 'input_tokens': 222, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '181918cd-b9f0-963a-b52f-3aa7c50ddfb7'}
2025-06-08 09:45:48,989 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 09:45:48,989 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=181918cd-b9f0-963a-b52f-3aa7c50ddfb7
2025-06-08 09:45:48,990 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '181918cd-b9f0-963a-b52f-3aa7c50ddfb7', 'choices': [{'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_e00f4efa187e4e88b8166e', 'type': 'function'}]})}], 'usage': {}}
2025-06-08 09:45:48,991 - gongdi-api - DEBUG - 工具调用信息: {'id': 'call_e00f4efa187e4e88b8166e', 'function_name': 'get_current_time', 'arguments': {}}
2025-06-08 09:45:48,992 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '181918cd-b9f0-963a-b52f-3aa7c50ddfb7', 'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_e00f4efa187e4e88b8166e', 'type': 'function'}]}), 'tool_calls': [{'id': 'call_e00f4efa187e4e88b8166e', 'function_name': 'get_current_time', 'arguments': {}}]}
2025-06-08 09:48:07,110 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:48:07,661 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:48:07,801 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:48:07,830 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:48:08,176 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:48:08,606 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:51:35,137 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '??????', 'tools': None}
2025-06-08 09:51:35,138 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:51:35,139 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: ??????
2025-06-08 09:51:35,140 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:51:35,141 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '??????'}]
2025-06-08 09:51:35,141 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:51:35,142 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:51:35,145 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:51:35,145 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 09:51:35,243 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '??????'}]}}
2025-06-08 09:51:35,250 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 09:51:38,230 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 09:51:38,232 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '您好！看起来您可能有具体的问题或需求需要帮助。如果您有任何问题或需要查询某些信息，请告诉我更多细节，我会尽力为您提供帮助。例如，您想了解当前时间、某个城市的天气情况，还是其他内容？请提供更多信息以便我更好地协助您。'}}]}, 'usage': {'total_tokens': 280, 'output_tokens': 57, 'input_tokens': 223, 'prompt_tokens_details': {'cached_tokens': 128}}, 'request_id': 'e9152157-f3fb-960a-847e-8686b3b9ee6b'}
2025-06-08 09:51:38,238 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 09:51:38,239 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=e9152157-f3fb-960a-847e-8686b3b9ee6b
2025-06-08 09:51:38,240 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'e9152157-f3fb-960a-847e-8686b3b9ee6b', 'choices': [{'message': Message({'role': 'assistant', 'content': '您好！看起来您可能有具体的问题或需求需要帮助。如果您有任何问题或需要查询某些信息，请告诉我更多细节，我会尽力为您提供帮助。例如，您想了解当前时间、某个城市的天气情况，还是其他内容？请提供更多信息以便我更好地协助您。'})}], 'usage': {}}
2025-06-08 09:51:38,241 - gongdi-api - DEBUG - 响应中没有工具调用
2025-06-08 09:51:40,835 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '??????', 'tools': None}
2025-06-08 09:51:40,836 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:51:40,838 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: ??????
2025-06-08 09:51:40,838 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:51:40,839 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '??????'}]
2025-06-08 09:51:40,839 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:51:40,841 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:51:40,843 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:51:40,843 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 09:51:40,845 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '??????'}]}}
2025-06-08 09:51:40,849 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 09:51:43,632 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 09:51:43,634 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '您好！看起来您可能有具体的问题或需求需要帮助。请告诉我您想了解什么信息或者需要解决什么问题？这样我可以更好地为您提供支持。'}}]}, 'usage': {'total_tokens': 255, 'output_tokens': 32, 'input_tokens': 223, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '95e7e3c4-fa21-9254-9cb6-5b039745da4c'}
2025-06-08 09:51:43,640 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 09:51:43,641 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=95e7e3c4-fa21-9254-9cb6-5b039745da4c
2025-06-08 09:51:43,641 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '95e7e3c4-fa21-9254-9cb6-5b039745da4c', 'choices': [{'message': Message({'role': 'assistant', 'content': '您好！看起来您可能有具体的问题或需求需要帮助。请告诉我您想了解什么信息或者需要解决什么问题？这样我可以更好地为您提供支持。'})}], 'usage': {}}
2025-06-08 09:51:43,643 - gongdi-api - DEBUG - 响应中没有工具调用
2025-06-08 09:52:05,437 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:52:05,515 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:52:05,861 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:52:05,929 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:52:06,103 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:52:06,727 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:52:08,919 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '现在几点了？', 'tools': None}
2025-06-08 09:52:08,920 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:52:08,921 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: 现在几点了？
2025-06-08 09:52:08,922 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:52:08,922 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '现在几点了？'}]
2025-06-08 09:52:08,923 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:52:08,924 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:52:08,925 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:52:08,926 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 09:52:09,219 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '现在几点了？'}]}}
2025-06-08 09:52:09,229 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 09:52:11,538 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 09:52:11,541 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'tool_calls', 'message': {'role': 'assistant', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_324db9b6027041bf8ac524', 'type': 'function'}], 'content': ''}}]}, 'usage': {'total_tokens': 238, 'output_tokens': 13, 'input_tokens': 225, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': 'b826f746-184b-906d-87dd-477206c8d476'}
2025-06-08 09:52:11,547 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 09:52:11,547 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=b826f746-184b-906d-87dd-477206c8d476
2025-06-08 09:52:11,548 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'b826f746-184b-906d-87dd-477206c8d476', 'choices': [{'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_324db9b6027041bf8ac524', 'type': 'function'}]})}], 'usage': {}}
2025-06-08 09:52:11,549 - gongdi-api - DEBUG - 工具调用信息: {'id': 'call_324db9b6027041bf8ac524', 'function_name': 'get_current_time', 'arguments': {}}
2025-06-08 09:52:11,550 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'b826f746-184b-906d-87dd-477206c8d476', 'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_324db9b6027041bf8ac524', 'type': 'function'}]}), 'tool_calls': [{'id': 'call_324db9b6027041bf8ac524', 'function_name': 'get_current_time', 'arguments': {}}]}
2025-06-08 09:52:11,589 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '杭州的天气怎么样？', 'tools': None}
2025-06-08 09:52:11,590 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:52:11,591 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: 杭州的天气怎么样？
2025-06-08 09:52:11,592 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:52:11,594 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '杭州的天气怎么样？'}]
2025-06-08 09:52:11,595 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:52:11,598 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:52:11,600 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:52:11,601 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 09:52:11,602 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '杭州的天气怎么样？'}]}}
2025-06-08 09:52:11,611 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 09:52:13,904 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 09:52:13,906 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'tool_calls', 'message': {'role': 'assistant', 'tool_calls': [{'function': {'name': 'get_current_weather', 'arguments': '{"location": "杭州市"}'}, 'index': 0, 'id': 'call_0d5952f3c25b40eab51afa', 'type': 'function'}], 'content': ''}}]}, 'usage': {'total_tokens': 244, 'output_tokens': 18, 'input_tokens': 226, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '3d156ed1-2305-9083-8b98-fbe7f9e28638'}
2025-06-08 09:52:13,912 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 09:52:13,913 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=3d156ed1-2305-9083-8b98-fbe7f9e28638
2025-06-08 09:52:13,914 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '3d156ed1-2305-9083-8b98-fbe7f9e28638', 'choices': [{'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_weather', 'arguments': '{"location": "杭州市"}'}, 'index': 0, 'id': 'call_0d5952f3c25b40eab51afa', 'type': 'function'}]})}], 'usage': {}}
2025-06-08 09:52:13,915 - gongdi-api - DEBUG - 工具调用信息: {'id': 'call_0d5952f3c25b40eab51afa', 'function_name': 'get_current_weather', 'arguments': {'location': '杭州市'}}
2025-06-08 09:52:13,916 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '3d156ed1-2305-9083-8b98-fbe7f9e28638', 'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_weather', 'arguments': '{"location": "杭州市"}'}, 'index': 0, 'id': 'call_0d5952f3c25b40eab51afa', 'type': 'function'}]}), 'tool_calls': [{'id': 'call_0d5952f3c25b40eab51afa', 'function_name': 'get_current_weather', 'arguments': {'location': '杭州市'}}]}
2025-06-08 09:52:13,939 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:52:13,940 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '北京现在几点了？天气怎么样？'}]
2025-06-08 09:52:13,941 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:52:13,942 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:52:13,944 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:52:13,945 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 09:52:13,946 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '北京现在几点了？天气怎么样？'}]}}
2025-06-08 09:52:13,951 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 09:52:16,331 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 09:52:16,335 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'tool_calls', 'message': {'role': 'assistant', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_d3d6020e591f41afa65c01', 'type': 'function'}], 'content': ''}}]}, 'usage': {'total_tokens': 242, 'output_tokens': 13, 'input_tokens': 229, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '4283bf28-065b-99ea-b9d1-b5df5b5b6653'}
2025-06-08 09:52:16,341 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 09:52:16,343 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=4283bf28-065b-99ea-b9d1-b5df5b5b6653
2025-06-08 09:52:16,343 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:52:16,344 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '北京现在几点了？天气怎么样？'}, {'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_d3d6020e591f41afa65c01', 'type': 'function'}]}, {'tool_call_id': 'call_d3d6020e591f41afa65c01', 'role': 'tool', 'content': '{"datetime": "2025-06-08 09:52:16", "date": "2025-06-08", "time": "09:52:16", "weekday": "Sunday"}'}]}}
2025-06-08 09:52:16,349 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 09:52:19,420 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 09:52:19,423 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '根据提供的信息，北京当前时间是 **2025年6月8日 星期日 09:52:16**。\n\n关于天气情况，由于你没有提供具体的天气数据，我无法直接告知当前的天气状况。不过，如果你需要查询实时天气，可以通过天气预报网站或相关应用程序获取最新的北京天气信息。'}}]}, 'usage': {'total_tokens': 160, 'output_tokens': 75, 'input_tokens': 85, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '2d96d04a-cd6d-93df-beb7-4ff17ad520ac'}
2025-06-08 09:52:56,698 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:52:56,751 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:52:57,016 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:52:57,142 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:52:57,746 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:52:59,533 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:53:00,959 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '现在几点了？', 'tools': None}
2025-06-08 09:53:00,960 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:53:00,961 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: 现在几点了？
2025-06-08 09:53:00,962 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:53:00,962 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '现在几点了？'}]
2025-06-08 09:53:00,963 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:53:00,965 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:53:00,966 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:53:00,967 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 09:53:01,165 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '现在几点了？'}]}}
2025-06-08 09:53:01,182 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 09:53:03,365 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 09:53:03,367 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'tool_calls', 'message': {'role': 'assistant', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_5cf2de9edec84bb7960aee', 'type': 'function'}], 'content': ''}}]}, 'usage': {'total_tokens': 238, 'output_tokens': 13, 'input_tokens': 225, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': 'b09cafb3-aa80-9a84-abe6-cdb0e4c9e260'}
2025-06-08 09:53:03,372 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 09:53:03,373 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=b09cafb3-aa80-9a84-abe6-cdb0e4c9e260
2025-06-08 09:53:03,374 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'b09cafb3-aa80-9a84-abe6-cdb0e4c9e260', 'choices': [{'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_5cf2de9edec84bb7960aee', 'type': 'function'}]})}], 'usage': {}}
2025-06-08 09:53:03,375 - gongdi-api - DEBUG - 工具调用信息: {'id': 'call_5cf2de9edec84bb7960aee', 'function_name': 'get_current_time', 'arguments': {}}
2025-06-08 09:53:03,375 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'b09cafb3-aa80-9a84-abe6-cdb0e4c9e260', 'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_5cf2de9edec84bb7960aee', 'type': 'function'}]}), 'tool_calls': [{'id': 'call_5cf2de9edec84bb7960aee', 'function_name': 'get_current_time', 'arguments': {}}]}
2025-06-08 09:53:03,409 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '杭州的天气怎么样？', 'tools': None}
2025-06-08 09:53:03,409 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:53:03,411 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: 杭州的天气怎么样？
2025-06-08 09:53:03,412 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:53:03,412 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '杭州的天气怎么样？'}]
2025-06-08 09:53:03,413 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:53:03,414 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:53:03,415 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:53:03,416 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 09:53:03,417 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '杭州的天气怎么样？'}]}}
2025-06-08 09:53:03,421 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 09:53:05,753 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 09:53:05,755 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'tool_calls', 'message': {'role': 'assistant', 'tool_calls': [{'function': {'name': 'get_current_weather', 'arguments': '{"location": "杭州市"}'}, 'index': 0, 'id': 'call_6f1086eb2f064b47b67913', 'type': 'function'}], 'content': ''}}]}, 'usage': {'total_tokens': 244, 'output_tokens': 18, 'input_tokens': 226, 'prompt_tokens_details': {'cached_tokens': 128}}, 'request_id': '77d14441-8b31-958a-b282-3bac69060908'}
2025-06-08 09:53:05,762 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 09:53:05,762 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=77d14441-8b31-958a-b282-3bac69060908
2025-06-08 09:53:05,763 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '77d14441-8b31-958a-b282-3bac69060908', 'choices': [{'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_weather', 'arguments': '{"location": "杭州市"}'}, 'index': 0, 'id': 'call_6f1086eb2f064b47b67913', 'type': 'function'}]})}], 'usage': {}}
2025-06-08 09:53:05,764 - gongdi-api - DEBUG - 工具调用信息: {'id': 'call_6f1086eb2f064b47b67913', 'function_name': 'get_current_weather', 'arguments': {'location': '杭州市'}}
2025-06-08 09:53:05,765 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '77d14441-8b31-958a-b282-3bac69060908', 'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_weather', 'arguments': '{"location": "杭州市"}'}, 'index': 0, 'id': 'call_6f1086eb2f064b47b67913', 'type': 'function'}]}), 'tool_calls': [{'id': 'call_6f1086eb2f064b47b67913', 'function_name': 'get_current_weather', 'arguments': {'location': '杭州市'}}]}
2025-06-08 09:53:05,792 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:53:05,792 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '北京现在几点了？天气怎么样？'}]
2025-06-08 09:53:05,793 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:53:05,795 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:53:05,796 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:53:05,796 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 09:53:05,797 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '北京现在几点了？天气怎么样？'}]}}
2025-06-08 09:53:05,802 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 09:53:08,062 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 09:53:08,064 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'tool_calls', 'message': {'role': 'assistant', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_58cb0213dbd74adea3a4d8', 'type': 'function'}], 'content': ''}}]}, 'usage': {'total_tokens': 242, 'output_tokens': 13, 'input_tokens': 229, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '8cc6d504-8d80-9dee-8a29-46ffc0a2dc47'}
2025-06-08 09:53:08,070 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 09:53:08,071 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=8cc6d504-8d80-9dee-8a29-46ffc0a2dc47
2025-06-08 09:53:08,071 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:53:08,072 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '北京现在几点了？天气怎么样？'}, {'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_58cb0213dbd74adea3a4d8', 'type': 'function'}]}, {'tool_call_id': 'call_58cb0213dbd74adea3a4d8', 'role': 'tool', 'content': '{"datetime": "2025-06-08 09:53:08", "date": "2025-06-08", "time": "09:53:08", "weekday": "Sunday"}'}]}}
2025-06-08 09:53:08,076 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 09:53:11,119 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 09:53:11,121 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '根据提供的信息，北京当前时间是 **2025年6月8日 星期日 09:53:08**。\n\n关于天气情况，由于你没有提供具体的天气数据，我无法直接告知当前的天气状况。不过，如果你需要查询实时天气，可以通过天气预报网站或相关应用程序获取最新的北京天气信息。'}}]}, 'usage': {'total_tokens': 160, 'output_tokens': 75, 'input_tokens': 85, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '39ebafef-78e9-9b92-9554-ab5bdb2bd66c'}
2025-06-08 09:53:35,621 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:53:36,589 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:53:37,645 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:53:37,824 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:53:37,857 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:53:38,754 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:53:42,010 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '现在几点了？', 'tools': None}
2025-06-08 09:53:42,010 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:53:42,012 - gongdi-api - DEBUG - 使用测试模式处理请求
2025-06-08 09:53:42,012 - gongdi-api - ERROR - 函数调用请求失败: name 'mock_function_call' is not defined
2025-06-08 09:53:42,024 - gongdi-api - ERROR - Traceback (most recent call last):
  File "C:\code\gongdi4\app.py", line 264, in function_call
    response = mock_function_call(request.query, tools)
               ^^^^^^^^^^^^^^^^^^
NameError: name 'mock_function_call' is not defined. Did you mean: 'function_call'?

2025-06-08 09:53:42,036 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '杭州的天气怎么样？', 'tools': None}
2025-06-08 09:53:42,037 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:53:42,038 - gongdi-api - DEBUG - 使用测试模式处理请求
2025-06-08 09:53:42,039 - gongdi-api - ERROR - 函数调用请求失败: name 'mock_function_call' is not defined
2025-06-08 09:53:42,049 - gongdi-api - ERROR - Traceback (most recent call last):
  File "C:\code\gongdi4\app.py", line 264, in function_call
    response = mock_function_call(request.query, tools)
               ^^^^^^^^^^^^^^^^^^
NameError: name 'mock_function_call' is not defined. Did you mean: 'function_call'?

2025-06-08 09:54:05,914 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:54:07,006 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:54:07,138 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:54:07,457 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:54:07,566 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:54:07,935 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:54:09,424 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '现在几点了？', 'tools': None}
2025-06-08 09:54:09,425 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:54:09,426 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: 现在几点了？
2025-06-08 09:54:09,426 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:54:09,427 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '现在几点了？'}]
2025-06-08 09:54:09,428 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:54:09,429 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:54:09,430 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:54:09,431 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 09:54:09,879 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '现在几点了？'}]}}
2025-06-08 09:54:09,903 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 09:54:12,161 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 09:54:12,163 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'tool_calls', 'message': {'role': 'assistant', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_e3a1db993f0f4e148885f2', 'type': 'function'}], 'content': ''}}]}, 'usage': {'total_tokens': 238, 'output_tokens': 13, 'input_tokens': 225, 'prompt_tokens_details': {'cached_tokens': 128}}, 'request_id': '2c457e80-7d63-9a70-b806-cd3012eac9b4'}
2025-06-08 09:54:12,169 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 09:54:12,170 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=2c457e80-7d63-9a70-b806-cd3012eac9b4
2025-06-08 09:54:12,170 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '2c457e80-7d63-9a70-b806-cd3012eac9b4', 'choices': [{'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_e3a1db993f0f4e148885f2', 'type': 'function'}]})}], 'usage': {}}
2025-06-08 09:54:12,171 - gongdi-api - DEBUG - 工具调用信息: {'id': 'call_e3a1db993f0f4e148885f2', 'function_name': 'get_current_time', 'arguments': {}}
2025-06-08 09:54:12,173 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '2c457e80-7d63-9a70-b806-cd3012eac9b4', 'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_e3a1db993f0f4e148885f2', 'type': 'function'}]}), 'tool_calls': [{'id': 'call_e3a1db993f0f4e148885f2', 'function_name': 'get_current_time', 'arguments': {}}]}
2025-06-08 09:54:12,208 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '杭州的天气怎么样？', 'tools': None}
2025-06-08 09:54:12,209 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:54:12,210 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: 杭州的天气怎么样？
2025-06-08 09:54:12,210 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:54:12,211 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '杭州的天气怎么样？'}]
2025-06-08 09:54:12,212 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:54:12,217 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:54:12,218 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:54:12,219 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 09:54:12,220 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '杭州的天气怎么样？'}]}}
2025-06-08 09:54:12,225 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 09:54:14,571 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 09:54:14,573 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'tool_calls', 'message': {'role': 'assistant', 'tool_calls': [{'function': {'name': 'get_current_weather', 'arguments': '{"location": "杭州市"}'}, 'index': 0, 'id': 'call_07111583b718423ebe2a4f', 'type': 'function'}], 'content': ''}}]}, 'usage': {'total_tokens': 244, 'output_tokens': 18, 'input_tokens': 226, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '02fad67a-d4ba-9c57-8f02-bfb836d204be'}
2025-06-08 09:54:14,577 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 09:54:14,577 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=02fad67a-d4ba-9c57-8f02-bfb836d204be
2025-06-08 09:54:14,578 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '02fad67a-d4ba-9c57-8f02-bfb836d204be', 'choices': [{'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_weather', 'arguments': '{"location": "杭州市"}'}, 'index': 0, 'id': 'call_07111583b718423ebe2a4f', 'type': 'function'}]})}], 'usage': {}}
2025-06-08 09:54:14,579 - gongdi-api - DEBUG - 工具调用信息: {'id': 'call_07111583b718423ebe2a4f', 'function_name': 'get_current_weather', 'arguments': {'location': '杭州市'}}
2025-06-08 09:54:14,580 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '02fad67a-d4ba-9c57-8f02-bfb836d204be', 'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_weather', 'arguments': '{"location": "杭州市"}'}, 'index': 0, 'id': 'call_07111583b718423ebe2a4f', 'type': 'function'}]}), 'tool_calls': [{'id': 'call_07111583b718423ebe2a4f', 'function_name': 'get_current_weather', 'arguments': {'location': '杭州市'}}]}
2025-06-08 09:54:14,601 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:54:14,602 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '北京现在几点了？天气怎么样？'}]
2025-06-08 09:54:14,603 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:54:14,605 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:54:14,606 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:54:14,606 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 09:54:14,607 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '北京现在几点了？天气怎么样？'}]}}
2025-06-08 09:54:14,612 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 09:54:16,826 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 09:54:16,828 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'tool_calls', 'message': {'role': 'assistant', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_867f858419fe4b93831e4a', 'type': 'function'}], 'content': ''}}]}, 'usage': {'total_tokens': 242, 'output_tokens': 13, 'input_tokens': 229, 'prompt_tokens_details': {'cached_tokens': 128}}, 'request_id': '2778ee74-c711-9e7e-9081-23a3857fd15e'}
2025-06-08 09:54:16,837 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 09:54:16,838 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=2778ee74-c711-9e7e-9081-23a3857fd15e
2025-06-08 09:54:16,839 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:54:16,840 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '北京现在几点了？天气怎么样？'}, {'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_867f858419fe4b93831e4a', 'type': 'function'}]}, {'tool_call_id': 'call_867f858419fe4b93831e4a', 'role': 'tool', 'content': '{"datetime": "2025-06-08 09:54:16", "date": "2025-06-08", "time": "09:54:16", "weekday": "Sunday"}'}]}}
2025-06-08 09:54:16,843 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 09:54:19,663 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 09:54:19,665 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '根据提供的信息，北京当前时间是 **2025年6月8日 星期日 09:54:16**。\n\n关于天气情况，由于您没有提供具体的天气数据，我无法直接告诉您当前的天气状况。不过，如果您需要查询实时天气，可以通过天气预报网站或相关应用程序获取最新的北京天气信息。'}}]}, 'usage': {'total_tokens': 161, 'output_tokens': 76, 'input_tokens': 85, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': 'b8df6874-f0f1-9392-858a-c38985e55383'}
2025-06-08 09:54:49,537 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:54:51,296 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:54:51,377 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:54:51,510 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:54:51,593 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:54:51,738 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:54:53,094 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '现在几点了？', 'tools': None}
2025-06-08 09:54:53,095 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:54:53,096 - gongdi-api - DEBUG - 使用测试模式处理请求
2025-06-08 09:54:53,097 - gongdi-api - ERROR - 函数调用请求失败: name 'mock_function_call' is not defined
2025-06-08 09:54:53,108 - gongdi-api - ERROR - Traceback (most recent call last):
  File "C:\code\gongdi4\app.py", line 264, in function_call
    response = mock_function_call(request.query, tools)
               ^^^^^^^^^^^^^^^^^^
NameError: name 'mock_function_call' is not defined. Did you mean: 'function_call'?

2025-06-08 09:55:27,244 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:55:27,996 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:55:28,284 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:55:29,216 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:55:30,294 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:55:30,575 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:55:46,881 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:55:48,371 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:55:49,070 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:55:49,152 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:58:05,940 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '现在几点了？', 'tools': None}
2025-06-08 09:58:05,941 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:58:05,942 - gongdi-api - DEBUG - 使用测试模式处理请求
2025-06-08 09:58:05,942 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'mock-func-12345', 'choices': [{'message': {'role': 'assistant', 'content': '', 'tool_calls': [{'id': 'mock-call-12345', 'type': 'function', 'function': {'name': 'get_current_time', 'arguments': '{}'}}]}}]}
2025-06-08 09:58:05,943 - gongdi-api - DEBUG - 工具调用信息: {'id': 'mock-call-12345', 'function_name': 'get_current_time', 'arguments': {}}
2025-06-08 09:58:05,944 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'mock-func-12345', 'message': {'role': 'assistant', 'content': '', 'tool_calls': [{'id': 'mock-call-12345', 'type': 'function', 'function': {'name': 'get_current_time', 'arguments': '{}'}}]}, 'tool_calls': [{'id': 'mock-call-12345', 'function_name': 'get_current_time', 'arguments': {}}]}
2025-06-08 09:58:10,511 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '现在几点了？', 'tools': None}
2025-06-08 09:58:10,512 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:58:10,513 - gongdi-api - DEBUG - 使用测试模式处理请求
2025-06-08 09:58:10,514 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'mock-func-12345', 'choices': [{'message': {'role': 'assistant', 'content': '', 'tool_calls': [{'id': 'mock-call-12345', 'type': 'function', 'function': {'name': 'get_current_time', 'arguments': '{}'}}]}}]}
2025-06-08 09:58:10,515 - gongdi-api - DEBUG - 工具调用信息: {'id': 'mock-call-12345', 'function_name': 'get_current_time', 'arguments': {}}
2025-06-08 09:58:10,516 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'mock-func-12345', 'message': {'role': 'assistant', 'content': '', 'tool_calls': [{'id': 'mock-call-12345', 'type': 'function', 'function': {'name': 'get_current_time', 'arguments': '{}'}}]}, 'tool_calls': [{'id': 'mock-call-12345', 'function_name': 'get_current_time', 'arguments': {}}]}
2025-06-08 09:58:10,533 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '杭州的天气怎么样？', 'tools': None}
2025-06-08 09:58:10,533 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:58:10,535 - gongdi-api - DEBUG - 使用测试模式处理请求
2025-06-08 09:58:10,535 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'mock-func-12345', 'choices': [{'message': {'role': 'assistant', 'content': '', 'tool_calls': [{'id': 'mock-call-12345', 'type': 'function', 'function': {'name': 'get_current_weather', 'arguments': '{"location": "\\u676d\\u5dde"}'}}]}}]}
2025-06-08 09:58:10,536 - gongdi-api - DEBUG - 工具调用信息: {'id': 'mock-call-12345', 'function_name': 'get_current_weather', 'arguments': {'location': '杭州'}}
2025-06-08 09:58:10,537 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'mock-func-12345', 'message': {'role': 'assistant', 'content': '', 'tool_calls': [{'id': 'mock-call-12345', 'type': 'function', 'function': {'name': 'get_current_weather', 'arguments': '{"location": "\\u676d\\u5dde"}'}}]}, 'tool_calls': [{'id': 'mock-call-12345', 'function_name': 'get_current_weather', 'arguments': {'location': '杭州'}}]}
2025-06-08 09:58:39,355 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:58:39,625 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:58:39,956 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:58:40,059 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:59:00,923 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:59:02,345 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:59:02,373 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:59:02,679 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:59:07,158 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:59:08,442 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:59:08,552 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:59:08,906 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:59:26,201 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:59:26,316 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:59:26,339 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:59:27,358 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:59:39,024 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:59:41,240 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:59:42,260 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:59:42,509 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:59:42,671 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 09:59:43,787 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '现在几点了？', 'tools': None}
2025-06-08 09:59:43,806 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:59:43,832 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: 现在几点了？
2025-06-08 09:59:43,843 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:59:43,868 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '现在几点了？'}]
2025-06-08 09:59:43,873 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:59:43,882 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:59:43,906 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:59:43,922 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 09:59:44,255 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '现在几点了？'}]}}
2025-06-08 09:59:44,265 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 09:59:46,538 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 09:59:46,540 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'tool_calls', 'message': {'role': 'assistant', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_096d70be309d4f8b869214', 'type': 'function'}], 'content': ''}}]}, 'usage': {'total_tokens': 238, 'output_tokens': 13, 'input_tokens': 225, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '689a2cc4-06a5-9ff5-974e-1b5191b7d885'}
2025-06-08 09:59:46,546 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 09:59:46,547 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=689a2cc4-06a5-9ff5-974e-1b5191b7d885
2025-06-08 09:59:46,547 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '689a2cc4-06a5-9ff5-974e-1b5191b7d885', 'choices': [{'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_096d70be309d4f8b869214', 'type': 'function'}]})}], 'usage': {}}
2025-06-08 09:59:46,548 - gongdi-api - DEBUG - 工具调用信息: {'id': 'call_096d70be309d4f8b869214', 'function_name': 'get_current_time', 'arguments': {}}
2025-06-08 09:59:46,549 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '689a2cc4-06a5-9ff5-974e-1b5191b7d885', 'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_096d70be309d4f8b869214', 'type': 'function'}]}), 'tool_calls': [{'id': 'call_096d70be309d4f8b869214', 'function_name': 'get_current_time', 'arguments': {}}]}
2025-06-08 09:59:46,581 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '杭州的天气怎么样？', 'tools': None}
2025-06-08 09:59:46,582 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:59:46,583 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: 杭州的天气怎么样？
2025-06-08 09:59:46,584 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:59:46,584 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '杭州的天气怎么样？'}]
2025-06-08 09:59:46,586 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:59:46,587 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:59:46,589 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:59:46,589 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 09:59:46,590 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '杭州的天气怎么样？'}]}}
2025-06-08 09:59:46,596 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 09:59:48,757 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 09:59:48,759 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'tool_calls', 'message': {'role': 'assistant', 'tool_calls': [{'function': {'name': 'get_current_weather', 'arguments': '{"location": "杭州市"}'}, 'index': 0, 'id': 'call_4b72cb93b24d4298b966fd', 'type': 'function'}], 'content': ''}}]}, 'usage': {'total_tokens': 244, 'output_tokens': 18, 'input_tokens': 226, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': 'aec54359-71e5-9527-bd89-f2bfd36b022c'}
2025-06-08 09:59:48,766 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 09:59:48,766 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=aec54359-71e5-9527-bd89-f2bfd36b022c
2025-06-08 09:59:48,767 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'aec54359-71e5-9527-bd89-f2bfd36b022c', 'choices': [{'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_weather', 'arguments': '{"location": "杭州市"}'}, 'index': 0, 'id': 'call_4b72cb93b24d4298b966fd', 'type': 'function'}]})}], 'usage': {}}
2025-06-08 09:59:48,768 - gongdi-api - DEBUG - 工具调用信息: {'id': 'call_4b72cb93b24d4298b966fd', 'function_name': 'get_current_weather', 'arguments': {'location': '杭州市'}}
2025-06-08 09:59:48,769 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'aec54359-71e5-9527-bd89-f2bfd36b022c', 'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_weather', 'arguments': '{"location": "杭州市"}'}, 'index': 0, 'id': 'call_4b72cb93b24d4298b966fd', 'type': 'function'}]}), 'tool_calls': [{'id': 'call_4b72cb93b24d4298b966fd', 'function_name': 'get_current_weather', 'arguments': {'location': '杭州市'}}]}
2025-06-08 09:59:48,792 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:59:48,793 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '北京现在几点了？天气怎么样？'}]
2025-06-08 09:59:48,794 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:59:48,796 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 09:59:48,797 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:59:48,798 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 09:59:48,799 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '北京现在几点了？天气怎么样？'}]}}
2025-06-08 09:59:48,803 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 09:59:50,901 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 09:59:50,902 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'tool_calls', 'message': {'role': 'assistant', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_b712a1eec23744e3ae499b', 'type': 'function'}], 'content': ''}}]}, 'usage': {'total_tokens': 242, 'output_tokens': 13, 'input_tokens': 229, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': 'e67e6380-e59c-9d48-bb9d-6c877eef546b'}
2025-06-08 09:59:50,906 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 09:59:50,907 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=e67e6380-e59c-9d48-bb9d-6c877eef546b
2025-06-08 09:59:50,908 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 09:59:50,909 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '北京现在几点了？天气怎么样？'}, {'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_b712a1eec23744e3ae499b', 'type': 'function'}]}, {'tool_call_id': 'call_b712a1eec23744e3ae499b', 'role': 'tool', 'content': '{"datetime": "2025-06-08 09:59:50", "date": "2025-06-08", "time": "09:59:50", "weekday": "Sunday"}'}]}}
2025-06-08 09:59:50,913 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 09:59:53,374 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 09:59:53,376 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '根据提供的信息，北京当前时间是 **2025年6月8日 星期日 上午09:59**。\n\n关于天气情况，由于你没有提供具体的天气数据，我无法直接告知天气状况。不过，如果你需要查询实时天气，可以通过天气预报网站或相关应用程序获取最新的北京天气信息。'}}]}, 'usage': {'total_tokens': 156, 'output_tokens': 71, 'input_tokens': 85, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': 'ed0a33e7-d7e7-95b2-8305-2de9f56991b2'}
2025-06-08 10:00:21,015 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 10:00:21,106 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 10:00:21,238 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 10:00:21,929 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 10:00:22,816 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 10:00:24,185 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '现在几点了？', 'tools': None}
2025-06-08 10:00:24,187 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 10:00:24,188 - gongdi-api - DEBUG - 使用测试模式处理请求
2025-06-08 10:00:24,189 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'mock-func-12345', 'choices': [{'message': {'role': 'assistant', 'content': '', 'tool_calls': [{'id': 'mock-call-12345', 'type': 'function', 'function': {'name': 'get_current_time', 'arguments': '{}'}}]}}]}
2025-06-08 10:00:24,190 - gongdi-api - DEBUG - 工具调用信息: {'id': 'mock-call-12345', 'function_name': 'get_current_time', 'arguments': {}}
2025-06-08 10:00:24,191 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'mock-func-12345', 'message': {'role': 'assistant', 'content': '', 'tool_calls': [{'id': 'mock-call-12345', 'type': 'function', 'function': {'name': 'get_current_time', 'arguments': '{}'}}]}, 'tool_calls': [{'id': 'mock-call-12345', 'function_name': 'get_current_time', 'arguments': {}}]}
2025-06-08 10:00:26,786 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 10:00:52,852 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 10:00:52,852 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 10:00:53,038 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 10:00:53,231 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 10:00:53,336 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 10:00:55,777 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '现在几点了？', 'tools': None}
2025-06-08 10:00:55,778 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 10:00:55,780 - gongdi-api - DEBUG - 使用测试模式处理请求
2025-06-08 10:00:55,780 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'mock-func-12345', 'choices': [{'message': {'role': 'assistant', 'content': '', 'tool_calls': [{'id': 'mock-call-12345', 'type': 'function', 'function': {'name': 'get_current_time', 'arguments': '{}'}}]}}]}
2025-06-08 10:00:55,781 - gongdi-api - DEBUG - 工具调用信息: {'id': 'mock-call-12345', 'function_name': 'get_current_time', 'arguments': {}}
2025-06-08 10:00:55,782 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'mock-func-12345', 'message': {'role': 'assistant', 'content': '', 'tool_calls': [{'id': 'mock-call-12345', 'type': 'function', 'function': {'name': 'get_current_time', 'arguments': '{}'}}]}, 'tool_calls': [{'id': 'mock-call-12345', 'function_name': 'get_current_time', 'arguments': {}}]}
2025-06-08 10:00:55,794 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '杭州的天气怎么样？', 'tools': None}
2025-06-08 10:00:55,795 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 10:00:55,797 - gongdi-api - DEBUG - 使用测试模式处理请求
2025-06-08 10:00:55,797 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'mock-func-12345', 'choices': [{'message': {'role': 'assistant', 'content': '', 'tool_calls': [{'id': 'mock-call-12345', 'type': 'function', 'function': {'name': 'get_current_weather', 'arguments': '{"location": "\\u676d\\u5dde"}'}}]}}]}
2025-06-08 10:00:55,798 - gongdi-api - DEBUG - 工具调用信息: {'id': 'mock-call-12345', 'function_name': 'get_current_weather', 'arguments': {'location': '杭州'}}
2025-06-08 10:00:55,799 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'mock-func-12345', 'message': {'role': 'assistant', 'content': '', 'tool_calls': [{'id': 'mock-call-12345', 'type': 'function', 'function': {'name': 'get_current_weather', 'arguments': '{"location": "\\u676d\\u5dde"}'}}]}, 'tool_calls': [{'id': 'mock-call-12345', 'function_name': 'get_current_weather', 'arguments': {'location': '杭州'}}]}
2025-06-08 10:01:02,803 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '现在几点了？', 'tools': None}
2025-06-08 10:01:02,804 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 10:01:02,806 - gongdi-api - DEBUG - 使用测试模式处理请求
2025-06-08 10:01:02,807 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'mock-func-12345', 'choices': [{'message': {'role': 'assistant', 'content': '', 'tool_calls': [{'id': 'mock-call-12345', 'type': 'function', 'function': {'name': 'get_current_time', 'arguments': '{}'}}]}}]}
2025-06-08 10:01:02,808 - gongdi-api - DEBUG - 工具调用信息: {'id': 'mock-call-12345', 'function_name': 'get_current_time', 'arguments': {}}
2025-06-08 10:01:02,809 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'mock-func-12345', 'message': {'role': 'assistant', 'content': '', 'tool_calls': [{'id': 'mock-call-12345', 'type': 'function', 'function': {'name': 'get_current_time', 'arguments': '{}'}}]}, 'tool_calls': [{'id': 'mock-call-12345', 'function_name': 'get_current_time', 'arguments': {}}]}
2025-06-08 10:01:25,527 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 10:01:26,590 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 10:01:26,609 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 10:01:26,746 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 10:01:26,778 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 10:01:29,318 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '现在几点了？', 'tools': None}
2025-06-08 10:01:29,318 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 10:01:29,320 - gongdi-api - DEBUG - 使用测试模式处理请求
2025-06-08 10:01:29,321 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'mock-func-12345', 'choices': [{'message': {'role': 'assistant', 'content': '', 'tool_calls': [{'id': 'mock-call-12345', 'type': 'function', 'function': {'name': 'get_current_time', 'arguments': '{}'}}]}}]}
2025-06-08 10:01:29,322 - gongdi-api - DEBUG - 工具调用信息: {'id': 'mock-call-12345', 'function_name': 'get_current_time', 'arguments': {}}
2025-06-08 10:01:29,323 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'mock-func-12345', 'message': {'role': 'assistant', 'content': '', 'tool_calls': [{'id': 'mock-call-12345', 'type': 'function', 'function': {'name': 'get_current_time', 'arguments': '{}'}}]}, 'tool_calls': [{'id': 'mock-call-12345', 'function_name': 'get_current_time', 'arguments': {}}]}
2025-06-08 10:01:29,337 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '杭州的天气怎么样？', 'tools': None}
2025-06-08 10:01:29,338 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 10:01:29,339 - gongdi-api - DEBUG - 使用测试模式处理请求
2025-06-08 10:01:29,340 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'mock-func-12345', 'choices': [{'message': {'role': 'assistant', 'content': '', 'tool_calls': [{'id': 'mock-call-12345', 'type': 'function', 'function': {'name': 'get_current_weather', 'arguments': '{"location": "\\u676d\\u5dde"}'}}]}}]}
2025-06-08 10:01:29,341 - gongdi-api - DEBUG - 工具调用信息: {'id': 'mock-call-12345', 'function_name': 'get_current_weather', 'arguments': {'location': '杭州'}}
2025-06-08 10:01:29,342 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'mock-func-12345', 'message': {'role': 'assistant', 'content': '', 'tool_calls': [{'id': 'mock-call-12345', 'type': 'function', 'function': {'name': 'get_current_weather', 'arguments': '{"location": "\\u676d\\u5dde"}'}}]}, 'tool_calls': [{'id': 'mock-call-12345', 'function_name': 'get_current_weather', 'arguments': {'location': '杭州'}}]}
2025-06-08 10:03:54,875 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '时间', 'tools': [{}]}
2025-06-08 10:03:54,876 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 10:03:54,877 - gongdi-api - DEBUG - 使用测试模式处理请求
2025-06-08 10:03:54,878 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'mock-func-12345', 'choices': [{'message': {'role': 'assistant', 'content': '', 'tool_calls': [{'id': 'mock-call-12345', 'type': 'function', 'function': {'name': 'get_current_time', 'arguments': '{}'}}]}}]}
2025-06-08 10:03:54,879 - gongdi-api - DEBUG - 工具调用信息: {'id': 'mock-call-12345', 'function_name': 'get_current_time', 'arguments': {}}
2025-06-08 10:03:54,880 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'mock-func-12345', 'message': {'role': 'assistant', 'content': '', 'tool_calls': [{'id': 'mock-call-12345', 'type': 'function', 'function': {'name': 'get_current_time', 'arguments': '{}'}}]}, 'tool_calls': [{'id': 'mock-call-12345', 'function_name': 'get_current_time', 'arguments': {}}]}
2025-06-08 10:05:25,231 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 10:05:49,049 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '天气', 'tools': [{}]}
2025-06-08 10:05:49,050 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 10:05:49,051 - gongdi-api - DEBUG - 使用测试模式处理请求
2025-06-08 10:05:49,052 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'mock-func-12345', 'choices': [{'message': {'role': 'assistant', 'content': '', 'tool_calls': [{'id': 'mock-call-12345', 'type': 'function', 'function': {'name': 'get_current_weather', 'arguments': '{"location": "\\u5317\\u4eac"}'}}]}}]}
2025-06-08 10:05:49,053 - gongdi-api - DEBUG - 工具调用信息: {'id': 'mock-call-12345', 'function_name': 'get_current_weather', 'arguments': {'location': '北京'}}
2025-06-08 10:05:49,053 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'mock-func-12345', 'message': {'role': 'assistant', 'content': '', 'tool_calls': [{'id': 'mock-call-12345', 'type': 'function', 'function': {'name': 'get_current_weather', 'arguments': '{"location": "\\u5317\\u4eac"}'}}]}, 'tool_calls': [{'id': 'mock-call-12345', 'function_name': 'get_current_weather', 'arguments': {'location': '北京'}}]}
2025-06-08 10:53:39,038 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 10:53:40,719 - gongdi-api - ERROR - 无法导入必要的模块，请检查依赖项
2025-06-08 10:53:45,024 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 10:53:46,978 - gongdi-api - ERROR - 无法导入必要的模块，请检查依赖项
2025-06-08 10:53:47,794 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 10:53:48,119 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 10:53:48,225 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 10:53:50,640 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 10:56:47,939 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '天气', 'tools': [{}]}
2025-06-08 10:56:47,940 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 10:56:47,941 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: 天气
2025-06-08 10:56:47,942 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 10:56:47,943 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '天气'}]
2025-06-08 10:56:47,943 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 10:56:47,945 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 10:56:47,946 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 10:56:47,947 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 10:56:48,031 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '天气'}]}}
2025-06-08 10:56:48,039 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 10:56:49,765 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 10:56:49,767 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '请告诉我您想查询哪个城市的天气？'}}]}, 'usage': {'total_tokens': 231, 'output_tokens': 9, 'input_tokens': 222, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': 'fbd76907-19e7-9a3d-af4d-5faadc74f37b'}
2025-06-08 10:56:49,773 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 10:56:49,773 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=fbd76907-19e7-9a3d-af4d-5faadc74f37b
2025-06-08 10:56:49,774 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'fbd76907-19e7-9a3d-af4d-5faadc74f37b', 'choices': [{'message': Message({'role': 'assistant', 'content': '请告诉我您想查询哪个城市的天气？'})}], 'usage': {}}
2025-06-08 10:56:49,775 - gongdi-api - DEBUG - 响应中没有工具调用
2025-06-08 10:58:37,731 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '时间', 'tools': [{}]}
2025-06-08 10:58:37,732 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 10:58:37,733 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: 时间
2025-06-08 10:58:37,734 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 10:58:37,734 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '时间'}]
2025-06-08 10:58:37,735 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 10:58:37,736 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 10:58:37,737 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 10:58:37,737 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 10:58:37,738 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '时间'}]}}
2025-06-08 10:58:37,742 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 10:58:40,232 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 10:58:40,234 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'tool_calls', 'message': {'role': 'assistant', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_6f4dc0e3136d4972a2724c', 'type': 'function'}], 'content': ''}}]}, 'usage': {'total_tokens': 235, 'output_tokens': 13, 'input_tokens': 222, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': 'dbd1c25b-b260-9903-9a5d-e12906d9ddc7'}
2025-06-08 10:58:40,240 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 10:58:40,240 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=dbd1c25b-b260-9903-9a5d-e12906d9ddc7
2025-06-08 10:58:40,241 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'dbd1c25b-b260-9903-9a5d-e12906d9ddc7', 'choices': [{'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_6f4dc0e3136d4972a2724c', 'type': 'function'}]})}], 'usage': {}}
2025-06-08 10:58:40,242 - gongdi-api - DEBUG - 工具调用信息: {'id': 'call_6f4dc0e3136d4972a2724c', 'function_name': 'get_current_time', 'arguments': {}}
2025-06-08 10:58:40,243 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'dbd1c25b-b260-9903-9a5d-e12906d9ddc7', 'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_6f4dc0e3136d4972a2724c', 'type': 'function'}]}), 'tool_calls': [{'id': 'call_6f4dc0e3136d4972a2724c', 'function_name': 'get_current_time', 'arguments': {}}]}
2025-06-08 11:01:42,524 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:01:42,657 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:05:49,746 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:05:49,767 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:05:49,788 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:05:50,005 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:05:50,684 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:05:51,182 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:06:46,259 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:06:46,906 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:06:47,590 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:06:47,673 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:06:47,812 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:07:20,450 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '时间', 'tools': [{}]}
2025-06-08 11:07:20,451 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:07:20,452 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: 时间
2025-06-08 11:07:20,453 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:07:20,454 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '时间'}]
2025-06-08 11:07:20,454 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:07:20,455 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:07:20,457 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:07:20,457 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 11:07:20,561 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '时间'}]}}
2025-06-08 11:07:20,569 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 11:07:22,752 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 11:07:22,754 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'tool_calls', 'message': {'role': 'assistant', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_cd2ab2efbd4647639bffb2', 'type': 'function'}], 'content': ''}}]}, 'usage': {'total_tokens': 235, 'output_tokens': 13, 'input_tokens': 222, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '2ca616e1-187e-9dc1-959b-ef6a6ee83801'}
2025-06-08 11:07:22,761 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 11:07:22,762 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=2ca616e1-187e-9dc1-959b-ef6a6ee83801
2025-06-08 11:07:22,762 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '2ca616e1-187e-9dc1-959b-ef6a6ee83801', 'choices': [{'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_cd2ab2efbd4647639bffb2', 'type': 'function'}]})}], 'usage': {}}
2025-06-08 11:07:22,763 - gongdi-api - DEBUG - 工具调用信息: {'id': 'call_cd2ab2efbd4647639bffb2', 'function_name': 'get_current_time', 'arguments': {}}
2025-06-08 11:07:22,764 - gongdi-api - DEBUG - 执行函数: get_current_time, 参数: {}
2025-06-08 11:07:22,765 - gongdi-api - DEBUG - 函数执行结果: {'datetime': '2025-06-08 11:07:22', 'date': '2025-06-08', 'time': '11:07:22', 'weekday': 'Sunday'}
2025-06-08 11:07:22,766 - gongdi-api - DEBUG - 最终返回结果: {'datetime': '2025-06-08 11:07:22', 'date': '2025-06-08', 'time': '11:07:22', 'weekday': 'Sunday', 'tool_calls': [{'id': 'call_cd2ab2efbd4647639bffb2', 'function_name': 'get_current_time', 'arguments': {}}], 'executed_results': [{'id': 'call_cd2ab2efbd4647639bffb2', 'function_name': 'get_current_time', 'success': True, 'result': {...}}]}
2025-06-08 11:10:47,470 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:10:58,755 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:11:00,123 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:11:00,133 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:11:00,273 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:11:01,197 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:11:01,653 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:12:17,866 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:12:18,144 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:12:18,415 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:12:18,865 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:12:19,874 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:12:19,916 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:12:22,256 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '时间', 'tools': [{}]}
2025-06-08 11:12:22,257 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:12:22,258 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: 时间
2025-06-08 11:12:22,258 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:12:22,259 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '时间'}]
2025-06-08 11:12:22,259 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:12:22,261 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:12:22,262 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:12:22,263 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 11:12:22,343 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '时间'}]}}
2025-06-08 11:12:22,351 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 11:12:24,567 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 11:12:24,570 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'tool_calls', 'message': {'role': 'assistant', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_4931f5d2597e4acd9f0b00', 'type': 'function'}], 'content': ''}}]}, 'usage': {'total_tokens': 235, 'output_tokens': 13, 'input_tokens': 222, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '95fc53e9-f0c8-9477-9b35-b1c3dee233f1'}
2025-06-08 11:12:24,573 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 11:12:24,574 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=95fc53e9-f0c8-9477-9b35-b1c3dee233f1
2025-06-08 11:12:24,575 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '95fc53e9-f0c8-9477-9b35-b1c3dee233f1', 'choices': [{'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_4931f5d2597e4acd9f0b00', 'type': 'function'}]})}], 'usage': {}}
2025-06-08 11:12:24,576 - gongdi-api - DEBUG - 工具调用信息: {'id': 'call_4931f5d2597e4acd9f0b00', 'function_name': 'get_current_time', 'arguments': {}}
2025-06-08 11:12:24,577 - gongdi-api - DEBUG - 执行函数: get_current_time, 参数: {}
2025-06-08 11:12:24,577 - gongdi-api - DEBUG - 函数执行结果: {'datetime': '2025-06-08 11:12:24', 'date': '2025-06-08', 'time': '11:12:24', 'weekday': 'Sunday'}
2025-06-08 11:12:24,578 - gongdi-api - DEBUG - 将函数调用结果返回给模型处理
2025-06-08 11:12:24,579 - gongdi-api - DEBUG - 发送给模型的完整消息: [{"role": "user", "content": "时间"}, {"role": "assistant", "content": "", "tool_calls": [{"function": {"name": "get_current_time", "arguments": "{}"}, "index": 0, "id": "call_4931f5d2597e4acd9f0b00", "type": "function"}]}, {"tool_call_id": "call_4931f5d2597e4acd9f0b00", "role": "tool", "content": "{\"datetime\": \"2025-06-08 11:12:24\", \"date\": \"2025-06-08\", \"time\": \"11:12:24\", \"weekday\": \"Sunday\"}"}]
2025-06-08 11:12:24,581 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:12:24,582 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '时间'}, {'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_4931f5d2597e4acd9f0b00', 'type': 'function'}]}, {'tool_call_id': 'call_4931f5d2597e4acd9f0b00', 'role': 'tool', 'content': '{"datetime": "2025-06-08 11:12:24", "date": "2025-06-08", "time": "11:12:24", "weekday": "Sunday"}'}]}}
2025-06-08 11:12:24,587 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 11:12:27,820 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 11:12:27,823 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': "The given data provides the following information about the time:\n\n- **Full datetime**: June 8, 2025, at 11:12:24 AM\n- **Date**: June 8, 2025\n- **Time**: 11:12:24 AM\n- **Weekday**: Sunday\n\nIs there anything specific you would like to know or any particular operation you'd like to perform with this time data?"}}]}, 'usage': {'total_tokens': 176, 'output_tokens': 97, 'input_tokens': 79, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '4e403c0b-75cf-9b23-95c7-93ea4c4669c5'}
2025-06-08 11:12:27,829 - gongdi-api - DEBUG - 模型最终响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '4e403c0b-75cf-9b23-95c7-93ea4c4669c5', 'choices': [{'message': {'content': "The given data provides the following information about the time:\n\n- **Full datetime**: June 8, 2025, at 11:12:24 AM\n- **Date**: June 8, 2025\n- **Time**: 11:12:24 AM\n- **Weekday**: Sunday\n\nIs there anything specific you would like to know or any particular operation you'd like to perform with this time data?", 'role': 'assistant'}}], 'usage': {}}
2025-06-08 11:12:27,831 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '95fc53e9-f0c8-9477-9b35-b1c3dee233f1', 'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_4931f5d2597e4acd9f0b00', 'type': 'function'}]}), 'tool_calls': [{'id': 'call_4931f5d2597e4acd9f0b00', 'function_name': 'get_current_time', 'arguments': {}}], 'executed_results': [{'id': 'call_4931f5d2597e4acd9f0b00', 'function_name': 'get_current_time', 'success': True, 'result': {'datetime': '2025-06-08 11:12:24', 'date': '2025-06-08', 'time': '11:12:24', 'weekday': 'Sunday'}}], 'final_answer': "The given data provides the following information about the time:\n\n- **Full datetime**: June 8, 2025, at 11:12:24 AM\n- **Date**: June 8, 2025\n- **Time**: 11:12:24 AM\n- **Weekday**: Sunday\n\nIs there anything specific you would like to know or any particular operation you'd like to perform with this time data?"}
2025-06-08 11:15:13,973 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '??????', 'tools': None}
2025-06-08 11:15:13,974 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:15:13,975 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: ??????
2025-06-08 11:15:13,975 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:15:13,976 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '??????'}]
2025-06-08 11:15:13,978 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:15:13,979 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:15:13,980 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:15:13,981 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 11:15:13,982 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '??????'}]}}
2025-06-08 11:15:13,987 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 11:15:16,416 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 11:15:16,417 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '您好！看起来您可能有具体的问题或需求需要帮助。请告诉我您想了解什么信息或者需要解决什么问题？这样我可以更好地为您提供支持。'}}]}, 'usage': {'total_tokens': 255, 'output_tokens': 32, 'input_tokens': 223, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': 'd186fe4c-8c5c-974b-931b-5fd05eba1d65'}
2025-06-08 11:15:16,421 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 11:15:16,421 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=d186fe4c-8c5c-974b-931b-5fd05eba1d65
2025-06-08 11:15:16,422 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'd186fe4c-8c5c-974b-931b-5fd05eba1d65', 'choices': [{'message': Message({'role': 'assistant', 'content': '您好！看起来您可能有具体的问题或需求需要帮助。请告诉我您想了解什么信息或者需要解决什么问题？这样我可以更好地为您提供支持。'})}], 'usage': {}}
2025-06-08 11:15:16,423 - gongdi-api - DEBUG - 响应中没有工具调用
2025-06-08 11:15:18,340 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '??????', 'tools': None}
2025-06-08 11:15:18,341 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:15:18,342 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: ??????
2025-06-08 11:15:18,343 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:15:18,343 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '??????'}]
2025-06-08 11:15:18,344 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:15:18,345 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:15:18,346 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:15:18,347 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 11:15:18,348 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '??????'}]}}
2025-06-08 11:15:18,352 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 11:15:20,966 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 11:15:20,968 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '您好！看起来您可能有具体的问题或需求需要帮助。请告诉我您想了解什么信息或者需要解决什么问题？这样我可以更好地为您提供支持。'}}]}, 'usage': {'total_tokens': 255, 'output_tokens': 32, 'input_tokens': 223, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '80cd8c2a-f95f-9b49-ab71-e3aef00b3836'}
2025-06-08 11:15:20,975 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 11:15:20,975 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=80cd8c2a-f95f-9b49-ab71-e3aef00b3836
2025-06-08 11:15:20,976 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '80cd8c2a-f95f-9b49-ab71-e3aef00b3836', 'choices': [{'message': Message({'role': 'assistant', 'content': '您好！看起来您可能有具体的问题或需求需要帮助。请告诉我您想了解什么信息或者需要解决什么问题？这样我可以更好地为您提供支持。'})}], 'usage': {}}
2025-06-08 11:15:20,977 - gongdi-api - DEBUG - 响应中没有工具调用
2025-06-08 11:15:31,825 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:15:31,830 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:15:38,341 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:15:38,383 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:15:42,040 - asyncio - DEBUG - Using selector: SelectSelector
2025-06-08 11:15:50,998 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:15:51,885 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:15:51,907 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:15:52,115 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:15:53,010 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:15:53,826 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:15:53,972 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:15:54,280 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:15:55,980 - asyncio - DEBUG - Using selector: SelectSelector
2025-06-08 11:15:56,593 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '现在几点了？', 'tools': None}
2025-06-08 11:15:56,594 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:15:56,596 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: 现在几点了？
2025-06-08 11:15:56,597 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:15:56,599 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '现在几点了？'}]
2025-06-08 11:15:56,600 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:15:56,603 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:15:56,605 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:15:56,606 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 11:15:56,717 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '现在几点了？'}]}}
2025-06-08 11:15:56,728 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 11:15:58,916 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 11:15:58,919 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'tool_calls', 'message': {'role': 'assistant', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_3dcb8bd7347b43fb824337', 'type': 'function'}], 'content': ''}}]}, 'usage': {'total_tokens': 238, 'output_tokens': 13, 'input_tokens': 225, 'prompt_tokens_details': {'cached_tokens': 128}}, 'request_id': '423bbcd4-62e8-93fb-a6d7-43ab09bd1194'}
2025-06-08 11:15:58,922 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 11:15:58,922 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=423bbcd4-62e8-93fb-a6d7-43ab09bd1194
2025-06-08 11:15:58,923 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '423bbcd4-62e8-93fb-a6d7-43ab09bd1194', 'choices': [{'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_3dcb8bd7347b43fb824337', 'type': 'function'}]})}], 'usage': {}}
2025-06-08 11:15:58,924 - gongdi-api - DEBUG - 工具调用信息: {'id': 'call_3dcb8bd7347b43fb824337', 'function_name': 'get_current_time', 'arguments': {}}
2025-06-08 11:15:58,924 - gongdi-api - DEBUG - 执行函数: get_current_time, 参数: {}
2025-06-08 11:15:58,925 - gongdi-api - DEBUG - 函数执行结果: {'datetime': '2025-06-08 11:15:58', 'date': '2025-06-08', 'time': '11:15:58', 'weekday': 'Sunday'}
2025-06-08 11:15:58,925 - gongdi-api - DEBUG - 将函数调用结果返回给模型处理
2025-06-08 11:15:58,926 - gongdi-api - DEBUG - 发送给模型的完整消息: [{"role": "user", "content": "现在几点了？"}, {"role": "assistant", "content": "", "tool_calls": [{"function": {"name": "get_current_time", "arguments": "{}"}, "index": 0, "id": "call_3dcb8bd7347b43fb824337", "type": "function"}]}, {"tool_call_id": "call_3dcb8bd7347b43fb824337", "role": "tool", "content": "{\"datetime\": \"2025-06-08 11:15:58\", \"date\": \"2025-06-08\", \"time\": \"11:15:58\", \"weekday\": \"Sunday\"}"}]
2025-06-08 11:15:58,927 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:15:58,927 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '现在几点了？'}, {'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_3dcb8bd7347b43fb824337', 'type': 'function'}]}, {'tool_call_id': 'call_3dcb8bd7347b43fb824337', 'role': 'tool', 'content': '{"datetime": "2025-06-08 11:15:58", "date": "2025-06-08", "time": "11:15:58", "weekday": "Sunday"}'}]}}
2025-06-08 11:15:58,930 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 11:16:01,351 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 11:16:01,353 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '现在的时间是2025年6月8日，星期日，上午11点15分58秒。'}}]}, 'usage': {'total_tokens': 108, 'output_tokens': 27, 'input_tokens': 81, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': 'a260ccc3-827b-9b64-8d86-f604cf403834'}
2025-06-08 11:16:01,357 - gongdi-api - DEBUG - 模型最终响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'a260ccc3-827b-9b64-8d86-f604cf403834', 'choices': [{'message': {'content': '现在的时间是2025年6月8日，星期日，上午11点15分58秒。', 'role': 'assistant'}}], 'usage': {}}
2025-06-08 11:16:01,357 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '423bbcd4-62e8-93fb-a6d7-43ab09bd1194', 'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_3dcb8bd7347b43fb824337', 'type': 'function'}]}), 'tool_calls': [{'id': 'call_3dcb8bd7347b43fb824337', 'function_name': 'get_current_time', 'arguments': {}}], 'executed_results': [{'id': 'call_3dcb8bd7347b43fb824337', 'function_name': 'get_current_time', 'success': True, 'result': {'datetime': '2025-06-08 11:15:58', 'date': '2025-06-08', 'time': '11:15:58', 'weekday': 'Sunday'}}], 'final_answer': '现在的时间是2025年6月8日，星期日，上午11点15分58秒。'}
2025-06-08 11:16:23,388 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:16:23,452 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:16:24,636 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:16:27,010 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:16:27,126 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:16:27,523 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:16:27,828 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:16:28,482 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:16:29,787 - asyncio - DEBUG - Using selector: SelectSelector
2025-06-08 11:16:31,857 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '现在几点了？', 'tools': None}
2025-06-08 11:16:31,860 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:16:31,863 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: 现在几点了？
2025-06-08 11:16:31,864 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:16:31,866 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '现在几点了？'}]
2025-06-08 11:16:31,875 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:16:31,877 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:16:31,879 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:16:31,879 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 11:16:32,005 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '现在几点了？'}]}}
2025-06-08 11:16:32,015 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 11:16:34,205 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 11:16:34,207 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'tool_calls', 'message': {'role': 'assistant', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_67b0043324644dc2942ff7', 'type': 'function'}], 'content': ''}}]}, 'usage': {'total_tokens': 238, 'output_tokens': 13, 'input_tokens': 225, 'prompt_tokens_details': {'cached_tokens': 128}}, 'request_id': '145eb902-72c3-95a5-a346-51bdc2bb9ad8'}
2025-06-08 11:16:34,214 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 11:16:34,215 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=145eb902-72c3-95a5-a346-51bdc2bb9ad8
2025-06-08 11:16:34,216 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '145eb902-72c3-95a5-a346-51bdc2bb9ad8', 'choices': [{'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_67b0043324644dc2942ff7', 'type': 'function'}]})}], 'usage': {}}
2025-06-08 11:16:34,217 - gongdi-api - DEBUG - 工具调用信息: {'id': 'call_67b0043324644dc2942ff7', 'function_name': 'get_current_time', 'arguments': {}}
2025-06-08 11:16:34,218 - gongdi-api - DEBUG - 执行函数: get_current_time, 参数: {}
2025-06-08 11:16:34,218 - gongdi-api - DEBUG - 函数执行结果: {'datetime': '2025-06-08 11:16:34', 'date': '2025-06-08', 'time': '11:16:34', 'weekday': 'Sunday'}
2025-06-08 11:16:34,219 - gongdi-api - DEBUG - 将函数调用结果返回给模型处理
2025-06-08 11:16:34,219 - gongdi-api - DEBUG - 发送给模型的完整消息: [{"role": "user", "content": "现在几点了？"}, {"role": "assistant", "content": "", "tool_calls": [{"function": {"name": "get_current_time", "arguments": "{}"}, "index": 0, "id": "call_67b0043324644dc2942ff7", "type": "function"}]}, {"tool_call_id": "call_67b0043324644dc2942ff7", "role": "tool", "content": "{\"datetime\": \"2025-06-08 11:16:34\", \"date\": \"2025-06-08\", \"time\": \"11:16:34\", \"weekday\": \"Sunday\"}"}]
2025-06-08 11:16:34,221 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:16:34,222 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '现在几点了？'}, {'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_67b0043324644dc2942ff7', 'type': 'function'}]}, {'tool_call_id': 'call_67b0043324644dc2942ff7', 'role': 'tool', 'content': '{"datetime": "2025-06-08 11:16:34", "date": "2025-06-08", "time": "11:16:34", "weekday": "Sunday"}'}]}}
2025-06-08 11:16:34,226 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 11:16:36,682 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 11:16:36,684 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '现在的时间是2025年6月8日，星期日，上午11点16分34秒。'}}]}, 'usage': {'total_tokens': 108, 'output_tokens': 27, 'input_tokens': 81, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '814261ff-f5b9-98aa-892e-8fc523a3652f'}
2025-06-08 11:16:36,690 - gongdi-api - DEBUG - 模型最终响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '814261ff-f5b9-98aa-892e-8fc523a3652f', 'choices': [{'message': {'content': '现在的时间是2025年6月8日，星期日，上午11点16分34秒。', 'role': 'assistant'}}], 'usage': {}}
2025-06-08 11:16:36,692 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '145eb902-72c3-95a5-a346-51bdc2bb9ad8', 'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_67b0043324644dc2942ff7', 'type': 'function'}]}), 'tool_calls': [{'id': 'call_67b0043324644dc2942ff7', 'function_name': 'get_current_time', 'arguments': {}}], 'executed_results': [{'id': 'call_67b0043324644dc2942ff7', 'function_name': 'get_current_time', 'success': True, 'result': {'datetime': '2025-06-08 11:16:34', 'date': '2025-06-08', 'time': '11:16:34', 'weekday': 'Sunday'}}], 'final_answer': '现在的时间是2025年6月8日，星期日，上午11点16分34秒。'}
2025-06-08 11:17:15,196 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:17:15,289 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:17:15,482 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:17:15,609 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:17:15,810 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:17:15,835 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:17:16,226 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:17:16,714 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:17:19,935 - asyncio - DEBUG - Using selector: SelectSelector
2025-06-08 11:17:20,296 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '现在几点了？', 'tools': None}
2025-06-08 11:17:20,296 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:17:20,297 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: 现在几点了？
2025-06-08 11:17:20,298 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:17:20,299 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '现在几点了？'}]
2025-06-08 11:17:20,299 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:17:20,301 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:17:20,302 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:17:20,302 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 11:17:20,455 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '现在几点了？'}]}}
2025-06-08 11:17:20,465 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 11:17:22,682 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 11:17:22,684 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'tool_calls', 'message': {'role': 'assistant', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_a3c0e8a20e974831ab4c9a', 'type': 'function'}], 'content': ''}}]}, 'usage': {'total_tokens': 238, 'output_tokens': 13, 'input_tokens': 225, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '275313b1-7cb0-9549-b3fe-0f95039005b1'}
2025-06-08 11:17:22,691 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 11:17:22,692 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=275313b1-7cb0-9549-b3fe-0f95039005b1
2025-06-08 11:17:22,692 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '275313b1-7cb0-9549-b3fe-0f95039005b1', 'choices': [{'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_a3c0e8a20e974831ab4c9a', 'type': 'function'}]})}], 'usage': {}}
2025-06-08 11:17:22,693 - gongdi-api - DEBUG - 工具调用信息: {'id': 'call_a3c0e8a20e974831ab4c9a', 'function_name': 'get_current_time', 'arguments': {}}
2025-06-08 11:17:22,694 - gongdi-api - DEBUG - 执行函数: get_current_time, 参数: {}
2025-06-08 11:17:22,695 - gongdi-api - DEBUG - 函数执行结果: {'datetime': '2025-06-08 11:17:22', 'date': '2025-06-08', 'time': '11:17:22', 'weekday': 'Sunday'}
2025-06-08 11:17:22,696 - gongdi-api - DEBUG - 将函数调用结果返回给模型处理
2025-06-08 11:17:22,697 - gongdi-api - DEBUG - 发送给模型的完整消息: [{"role": "user", "content": "现在几点了？"}, {"role": "assistant", "content": "", "tool_calls": [{"function": {"name": "get_current_time", "arguments": "{}"}, "index": 0, "id": "call_a3c0e8a20e974831ab4c9a", "type": "function"}]}, {"tool_call_id": "call_a3c0e8a20e974831ab4c9a", "role": "tool", "content": "{\"datetime\": \"2025-06-08 11:17:22\", \"date\": \"2025-06-08\", \"time\": \"11:17:22\", \"weekday\": \"Sunday\"}"}]
2025-06-08 11:17:22,698 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:17:22,699 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '现在几点了？'}, {'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_a3c0e8a20e974831ab4c9a', 'type': 'function'}]}, {'tool_call_id': 'call_a3c0e8a20e974831ab4c9a', 'role': 'tool', 'content': '{"datetime": "2025-06-08 11:17:22", "date": "2025-06-08", "time": "11:17:22", "weekday": "Sunday"}'}]}}
2025-06-08 11:17:22,703 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 11:17:24,989 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 11:17:24,992 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '现在的时间是2025年6月8日，星期日，上午11点17分22秒。'}}]}, 'usage': {'total_tokens': 108, 'output_tokens': 27, 'input_tokens': 81, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '85f235b9-8cbe-9649-a51b-cbf796eeabb8'}
2025-06-08 11:17:24,996 - gongdi-api - DEBUG - 模型最终响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '85f235b9-8cbe-9649-a51b-cbf796eeabb8', 'choices': [{'message': {'content': '现在的时间是2025年6月8日，星期日，上午11点17分22秒。', 'role': 'assistant'}}], 'usage': {}}
2025-06-08 11:17:24,997 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '275313b1-7cb0-9549-b3fe-0f95039005b1', 'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_a3c0e8a20e974831ab4c9a', 'type': 'function'}]}), 'tool_calls': [{'id': 'call_a3c0e8a20e974831ab4c9a', 'function_name': 'get_current_time', 'arguments': {}}], 'executed_results': [{'id': 'call_a3c0e8a20e974831ab4c9a', 'function_name': 'get_current_time', 'success': True, 'result': {'datetime': '2025-06-08 11:17:22', 'date': '2025-06-08', 'time': '11:17:22', 'weekday': 'Sunday'}}], 'final_answer': '现在的时间是2025年6月8日，星期日，上午11点17分22秒。'}
2025-06-08 11:18:13,382 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:18:13,437 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:18:13,936 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:18:13,934 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:18:14,714 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:18:14,731 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:18:14,782 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:18:15,774 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:18:18,217 - asyncio - DEBUG - Using selector: SelectSelector
2025-06-08 11:18:18,627 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '现在几点了？', 'tools': None}
2025-06-08 11:18:18,628 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:18:18,629 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: 现在几点了？
2025-06-08 11:18:18,630 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:18:18,631 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '现在几点了？'}]
2025-06-08 11:18:18,631 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:18:18,632 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:18:18,633 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:18:18,634 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 11:18:18,904 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '现在几点了？'}]}}
2025-06-08 11:18:18,914 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 11:18:21,102 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 11:18:21,105 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'tool_calls', 'message': {'role': 'assistant', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_3435cc24ade046e1bdb64b', 'type': 'function'}], 'content': ''}}]}, 'usage': {'total_tokens': 238, 'output_tokens': 13, 'input_tokens': 225, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '74d05e9e-593b-99ad-be76-e2a09d65cc85'}
2025-06-08 11:18:21,111 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 11:18:21,112 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=74d05e9e-593b-99ad-be76-e2a09d65cc85
2025-06-08 11:18:21,113 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '74d05e9e-593b-99ad-be76-e2a09d65cc85', 'choices': [{'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_3435cc24ade046e1bdb64b', 'type': 'function'}]})}], 'usage': {}}
2025-06-08 11:18:21,114 - gongdi-api - DEBUG - 工具调用信息: {'id': 'call_3435cc24ade046e1bdb64b', 'function_name': 'get_current_time', 'arguments': {}}
2025-06-08 11:18:21,115 - gongdi-api - DEBUG - 执行函数: get_current_time, 参数: {}
2025-06-08 11:18:21,115 - gongdi-api - DEBUG - 函数执行结果: {'datetime': '2025-06-08 11:18:21', 'date': '2025-06-08', 'time': '11:18:21', 'weekday': 'Sunday'}
2025-06-08 11:18:21,116 - gongdi-api - DEBUG - 将函数调用结果返回给模型处理
2025-06-08 11:18:21,117 - gongdi-api - DEBUG - 发送给模型的完整消息: [{"role": "user", "content": "现在几点了？"}, {"role": "assistant", "content": "", "tool_calls": [{"function": {"name": "get_current_time", "arguments": "{}"}, "index": 0, "id": "call_3435cc24ade046e1bdb64b", "type": "function"}]}, {"tool_call_id": "call_3435cc24ade046e1bdb64b", "role": "tool", "content": "{\"datetime\": \"2025-06-08 11:18:21\", \"date\": \"2025-06-08\", \"time\": \"11:18:21\", \"weekday\": \"Sunday\"}"}]
2025-06-08 11:18:21,118 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:18:21,119 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '现在几点了？'}, {'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_3435cc24ade046e1bdb64b', 'type': 'function'}]}, {'tool_call_id': 'call_3435cc24ade046e1bdb64b', 'role': 'tool', 'content': '{"datetime": "2025-06-08 11:18:21", "date": "2025-06-08", "time": "11:18:21", "weekday": "Sunday"}'}]}}
2025-06-08 11:18:21,124 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 11:18:23,636 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 11:18:23,638 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '现在的时间是2025年6月8日，星期日，上午11点18分21秒。'}}]}, 'usage': {'total_tokens': 108, 'output_tokens': 27, 'input_tokens': 81, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '5224c79f-8962-91ac-bebf-7d3224717562'}
2025-06-08 11:18:23,643 - gongdi-api - DEBUG - 模型最终响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '5224c79f-8962-91ac-bebf-7d3224717562', 'choices': [{'message': {'content': '现在的时间是2025年6月8日，星期日，上午11点18分21秒。', 'role': 'assistant'}}], 'usage': {}}
2025-06-08 11:18:23,645 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '74d05e9e-593b-99ad-be76-e2a09d65cc85', 'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_3435cc24ade046e1bdb64b', 'type': 'function'}]}), 'tool_calls': [{'id': 'call_3435cc24ade046e1bdb64b', 'function_name': 'get_current_time', 'arguments': {}}], 'executed_results': [{'id': 'call_3435cc24ade046e1bdb64b', 'function_name': 'get_current_time', 'success': True, 'result': {'datetime': '2025-06-08 11:18:21', 'date': '2025-06-08', 'time': '11:18:21', 'weekday': 'Sunday'}}], 'final_answer': '现在的时间是2025年6月8日，星期日，上午11点18分21秒。'}
2025-06-08 11:18:57,653 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:18:57,756 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:18:57,961 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:18:58,312 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:18:59,290 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:19:17,377 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:19:17,845 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:19:19,408 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:19:19,419 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:19:19,486 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:19:59,977 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:20:28,905 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:20:28,911 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:20:30,068 - asyncio - DEBUG - Using selector: SelectSelector
2025-06-08 11:21:49,271 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:21:49,314 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:21:49,746 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:21:49,796 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:21:49,835 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:21:50,676 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:21:51,029 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:21:53,015 - asyncio - DEBUG - Using selector: SelectSelector
2025-06-08 11:21:58,598 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '时间', 'tools': [{}]}
2025-06-08 11:21:58,599 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:21:58,600 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: 时间
2025-06-08 11:21:58,601 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:21:58,601 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '时间'}]
2025-06-08 11:21:58,602 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:21:58,603 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:21:58,604 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:21:58,605 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 11:21:58,695 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '时间'}]}}
2025-06-08 11:21:58,705 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 11:22:00,852 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 11:22:00,854 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'tool_calls', 'message': {'role': 'assistant', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_b60aaa1db6bb47d7893b54', 'type': 'function'}], 'content': ''}}]}, 'usage': {'total_tokens': 235, 'output_tokens': 13, 'input_tokens': 222, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '0ebe7ed1-1a37-90dc-a425-eb4ca0251967'}
2025-06-08 11:22:00,862 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 11:22:00,862 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=0ebe7ed1-1a37-90dc-a425-eb4ca0251967
2025-06-08 11:22:00,863 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '0ebe7ed1-1a37-90dc-a425-eb4ca0251967', 'choices': [{'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_b60aaa1db6bb47d7893b54', 'type': 'function'}]})}], 'usage': {}}
2025-06-08 11:22:00,865 - gongdi-api - DEBUG - 工具调用信息: {'id': 'call_b60aaa1db6bb47d7893b54', 'function_name': 'get_current_time', 'arguments': {}}
2025-06-08 11:22:00,865 - gongdi-api - DEBUG - 执行函数: get_current_time, 参数: {}
2025-06-08 11:22:00,866 - gongdi-api - DEBUG - 函数执行结果: {'datetime': '2025-06-08 11:22:00', 'date': '2025-06-08', 'time': '11:22:00', 'weekday': 'Sunday'}
2025-06-08 11:22:00,867 - gongdi-api - DEBUG - 将函数调用结果返回给模型处理
2025-06-08 11:22:00,868 - gongdi-api - DEBUG - 发送给模型的完整消息: [{"role": "user", "content": "时间"}, {"role": "assistant", "content": "", "tool_calls": [{"function": {"name": "get_current_time", "arguments": "{}"}, "index": 0, "id": "call_b60aaa1db6bb47d7893b54", "type": "function"}]}, {"tool_call_id": "call_b60aaa1db6bb47d7893b54", "role": "tool", "content": "{\"datetime\": \"2025-06-08 11:22:00\", \"date\": \"2025-06-08\", \"time\": \"11:22:00\", \"weekday\": \"Sunday\"}"}]
2025-06-08 11:22:00,869 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:22:00,870 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '时间'}, {'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_b60aaa1db6bb47d7893b54', 'type': 'function'}]}, {'tool_call_id': 'call_b60aaa1db6bb47d7893b54', 'role': 'tool', 'content': '{"datetime": "2025-06-08 11:22:00", "date": "2025-06-08", "time": "11:22:00", "weekday": "Sunday"}'}]}}
2025-06-08 11:22:00,876 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 11:22:04,338 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 11:22:04,340 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': "The given data provides the following information about the time:\n\n- **Full datetime**: June 8, 2025, at 11:22:00 AM\n- **Date**: June 8, 2025\n- **Time**: 11:22:00 AM\n- **Weekday**: Sunday\n\nIs there anything specific you would like to know or any particular operation you'd like to perform with this time data?"}}]}, 'usage': {'total_tokens': 176, 'output_tokens': 97, 'input_tokens': 79, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '30dfb514-fd89-9d48-9230-65709b1ba7c8'}
2025-06-08 11:22:04,345 - gongdi-api - DEBUG - 模型最终响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '30dfb514-fd89-9d48-9230-65709b1ba7c8', 'choices': [{'message': {'content': "The given data provides the following information about the time:\n\n- **Full datetime**: June 8, 2025, at 11:22:00 AM\n- **Date**: June 8, 2025\n- **Time**: 11:22:00 AM\n- **Weekday**: Sunday\n\nIs there anything specific you would like to know or any particular operation you'd like to perform with this time data?", 'role': 'assistant'}}], 'usage': {}}
2025-06-08 11:22:04,347 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '0ebe7ed1-1a37-90dc-a425-eb4ca0251967', 'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_b60aaa1db6bb47d7893b54', 'type': 'function'}]}), 'tool_calls': [{'id': 'call_b60aaa1db6bb47d7893b54', 'function_name': 'get_current_time', 'arguments': {}}], 'executed_results': [{'id': 'call_b60aaa1db6bb47d7893b54', 'function_name': 'get_current_time', 'success': True, 'result': {'datetime': '2025-06-08 11:22:00', 'date': '2025-06-08', 'time': '11:22:00', 'weekday': 'Sunday'}}], 'final_answer': "The given data provides the following information about the time:\n\n- **Full datetime**: June 8, 2025, at 11:22:00 AM\n- **Date**: June 8, 2025\n- **Time**: 11:22:00 AM\n- **Weekday**: Sunday\n\nIs there anything specific you would like to know or any particular operation you'd like to perform with this time data?"}
2025-06-08 11:22:54,068 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '北京天气如何', 'tools': [{}]}
2025-06-08 11:22:54,071 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:22:54,073 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: 北京天气如何
2025-06-08 11:22:54,074 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:22:54,074 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '北京天气如何'}]
2025-06-08 11:22:54,075 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:22:54,078 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:22:54,079 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:22:54,080 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 11:22:54,081 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '北京天气如何'}]}}
2025-06-08 11:22:54,087 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 11:22:56,402 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 11:22:56,404 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'tool_calls', 'message': {'role': 'assistant', 'tool_calls': [{'function': {'name': 'get_current_weather', 'arguments': '{"location": "北京市"}'}, 'index': 0, 'id': 'call_13b7b34a624c48928caa48', 'type': 'function'}], 'content': ''}}]}, 'usage': {'total_tokens': 242, 'output_tokens': 18, 'input_tokens': 224, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '90ac821e-ab0d-9619-bc7c-0906b1cd7cc6'}
2025-06-08 11:22:56,411 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 11:22:56,411 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=90ac821e-ab0d-9619-bc7c-0906b1cd7cc6
2025-06-08 11:22:56,412 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '90ac821e-ab0d-9619-bc7c-0906b1cd7cc6', 'choices': [{'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_weather', 'arguments': '{"location": "北京市"}'}, 'index': 0, 'id': 'call_13b7b34a624c48928caa48', 'type': 'function'}]})}], 'usage': {}}
2025-06-08 11:22:56,413 - gongdi-api - DEBUG - 工具调用信息: {'id': 'call_13b7b34a624c48928caa48', 'function_name': 'get_current_weather', 'arguments': {'location': '北京市'}}
2025-06-08 11:22:56,414 - gongdi-api - DEBUG - 执行函数: get_current_weather, 参数: {'location': '北京市'}
2025-06-08 11:22:56,414 - gongdi-api - DEBUG - 函数执行结果: {'temp': '20°C', 'condition': '晴', 'humidity': '60%', 'wind': '微风'}
2025-06-08 11:22:56,415 - gongdi-api - DEBUG - 将函数调用结果返回给模型处理
2025-06-08 11:22:56,416 - gongdi-api - DEBUG - 发送给模型的完整消息: [{"role": "user", "content": "北京天气如何"}, {"role": "assistant", "content": "", "tool_calls": [{"function": {"name": "get_current_weather", "arguments": "{\"location\": \"北京市\"}"}, "index": 0, "id": "call_13b7b34a624c48928caa48", "type": "function"}]}, {"tool_call_id": "call_13b7b34a624c48928caa48", "role": "tool", "content": "{\"temp\": \"20\\u00b0C\", \"condition\": \"\\u6674\", \"humidity\": \"60%\", \"wind\": \"\\u5fae\\u98ce\"}"}]
2025-06-08 11:22:56,417 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:22:56,418 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '北京天气如何'}, {'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_weather', 'arguments': '{"location": "北京市"}'}, 'index': 0, 'id': 'call_13b7b34a624c48928caa48', 'type': 'function'}]}, {'tool_call_id': 'call_13b7b34a624c48928caa48', 'role': 'tool', 'content': '{"temp": "20\\u00b0C", "condition": "\\u6674", "humidity": "60%", "wind": "\\u5fae\\u98ce"}'}]}}
2025-06-08 11:22:56,423 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 11:22:59,011 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 11:22:59,013 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '当前北京的天气情况如下：\n- 温度：20°C\n- 天气状况：晴朗\n- 湿度：60%\n- 风力：微风\n\n请注意适当增减衣物，保持舒适。'}}]}, 'usage': {'total_tokens': 118, 'output_tokens': 52, 'input_tokens': 66, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '2055f3ad-21ab-97fd-b94c-06e9bf77d6e3'}
2025-06-08 11:22:59,017 - gongdi-api - DEBUG - 模型最终响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '2055f3ad-21ab-97fd-b94c-06e9bf77d6e3', 'choices': [{'message': {'content': '当前北京的天气情况如下：\n- 温度：20°C\n- 天气状况：晴朗\n- 湿度：60%\n- 风力：微风\n\n请注意适当增减衣物，保持舒适。', 'role': 'assistant'}}], 'usage': {}}
2025-06-08 11:22:59,018 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '90ac821e-ab0d-9619-bc7c-0906b1cd7cc6', 'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_weather', 'arguments': '{"location": "北京市"}'}, 'index': 0, 'id': 'call_13b7b34a624c48928caa48', 'type': 'function'}]}), 'tool_calls': [{'id': 'call_13b7b34a624c48928caa48', 'function_name': 'get_current_weather', 'arguments': {'location': '北京市'}}], 'executed_results': [{'id': 'call_13b7b34a624c48928caa48', 'function_name': 'get_current_weather', 'success': True, 'result': {'temp': '20°C', 'condition': '晴', 'humidity': '60%', 'wind': '微风'}}], 'final_answer': '当前北京的天气情况如下：\n- 温度：20°C\n- 天气状况：晴朗\n- 湿度：60%\n- 风力：微风\n\n请注意适当增减衣物，保持舒适。'}
2025-06-08 11:23:09,769 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:23:17,479 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '北京时间？', 'tools': [{}]}
2025-06-08 11:23:17,480 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:23:17,481 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: 北京时间？
2025-06-08 11:23:17,481 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:23:17,482 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '北京时间？'}]
2025-06-08 11:23:17,482 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:23:17,483 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:23:17,484 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:23:17,485 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 11:23:17,486 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '北京时间？'}]}}
2025-06-08 11:23:17,491 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 11:23:19,822 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 11:23:19,824 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'tool_calls', 'message': {'role': 'assistant', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_3718712314a6491794825a', 'type': 'function'}], 'content': ''}}]}, 'usage': {'total_tokens': 236, 'output_tokens': 13, 'input_tokens': 223, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': 'cb0be3af-4e6d-98cb-a9e3-471b91354d6f'}
2025-06-08 11:23:19,829 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 11:23:19,830 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=cb0be3af-4e6d-98cb-a9e3-471b91354d6f
2025-06-08 11:23:19,831 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'cb0be3af-4e6d-98cb-a9e3-471b91354d6f', 'choices': [{'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_3718712314a6491794825a', 'type': 'function'}]})}], 'usage': {}}
2025-06-08 11:23:19,832 - gongdi-api - DEBUG - 工具调用信息: {'id': 'call_3718712314a6491794825a', 'function_name': 'get_current_time', 'arguments': {}}
2025-06-08 11:23:19,833 - gongdi-api - DEBUG - 执行函数: get_current_time, 参数: {}
2025-06-08 11:23:19,834 - gongdi-api - DEBUG - 函数执行结果: {'datetime': '2025-06-08 11:23:19', 'date': '2025-06-08', 'time': '11:23:19', 'weekday': 'Sunday'}
2025-06-08 11:23:19,834 - gongdi-api - DEBUG - 将函数调用结果返回给模型处理
2025-06-08 11:23:19,835 - gongdi-api - DEBUG - 发送给模型的完整消息: [{"role": "user", "content": "北京时间？"}, {"role": "assistant", "content": "", "tool_calls": [{"function": {"name": "get_current_time", "arguments": "{}"}, "index": 0, "id": "call_3718712314a6491794825a", "type": "function"}]}, {"tool_call_id": "call_3718712314a6491794825a", "role": "tool", "content": "{\"datetime\": \"2025-06-08 11:23:19\", \"date\": \"2025-06-08\", \"time\": \"11:23:19\", \"weekday\": \"Sunday\"}"}]
2025-06-08 11:23:19,836 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:23:19,837 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '北京时间？'}, {'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_3718712314a6491794825a', 'type': 'function'}]}, {'tool_call_id': 'call_3718712314a6491794825a', 'role': 'tool', 'content': '{"datetime": "2025-06-08 11:23:19", "date": "2025-06-08", "time": "11:23:19", "weekday": "Sunday"}'}]}}
2025-06-08 11:23:19,841 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 11:23:22,689 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 11:23:22,692 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '根据您提供的信息，当前的北京时间是 **2025年6月8日星期日，上午11点23分19秒**。'}}]}, 'usage': {'total_tokens': 113, 'output_tokens': 34, 'input_tokens': 79, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': 'c14bae81-dd42-9272-87e2-c1fd35bef38d'}
2025-06-08 11:23:22,697 - gongdi-api - DEBUG - 模型最终响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'c14bae81-dd42-9272-87e2-c1fd35bef38d', 'choices': [{'message': {'content': '根据您提供的信息，当前的北京时间是 **2025年6月8日星期日，上午11点23分19秒**。', 'role': 'assistant'}}], 'usage': {}}
2025-06-08 11:23:22,698 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'cb0be3af-4e6d-98cb-a9e3-471b91354d6f', 'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_3718712314a6491794825a', 'type': 'function'}]}), 'tool_calls': [{'id': 'call_3718712314a6491794825a', 'function_name': 'get_current_time', 'arguments': {}}], 'executed_results': [{'id': 'call_3718712314a6491794825a', 'function_name': 'get_current_time', 'success': True, 'result': {'datetime': '2025-06-08 11:23:19', 'date': '2025-06-08', 'time': '11:23:19', 'weekday': 'Sunday'}}], 'final_answer': '根据您提供的信息，当前的北京时间是 **2025年6月8日星期日，上午11点23分19秒**。'}
2025-06-08 11:24:08,728 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '有什么风险吗？', 'tools': [{}]}
2025-06-08 11:24:08,729 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:24:08,731 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: 有什么风险吗？
2025-06-08 11:24:08,731 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:24:08,732 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '有什么风险吗？'}]
2025-06-08 11:24:08,732 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:24:08,734 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:24:08,735 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:24:08,735 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 11:24:08,736 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '有什么风险吗？'}]}}
2025-06-08 11:24:08,741 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 11:24:11,538 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 11:24:11,540 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '您的问题比较宽泛，风险可能涉及很多方面，例如金融投资风险、健康风险、技术风险等。如果您能提供更具体的情境或者领域，我可以为您提供更有针对性的信息和建议。'}}]}, 'usage': {'total_tokens': 267, 'output_tokens': 42, 'input_tokens': 225, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': 'e18d3fdd-b629-97ac-9dac-3be17776b7ce'}
2025-06-08 11:24:11,544 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 11:24:11,545 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=e18d3fdd-b629-97ac-9dac-3be17776b7ce
2025-06-08 11:24:11,546 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': 'e18d3fdd-b629-97ac-9dac-3be17776b7ce', 'choices': [{'message': Message({'role': 'assistant', 'content': '您的问题比较宽泛，风险可能涉及很多方面，例如金融投资风险、健康风险、技术风险等。如果您能提供更具体的情境或者领域，我可以为您提供更有针对性的信息和建议。'})}], 'usage': {}}
2025-06-08 11:24:11,548 - gongdi-api - DEBUG - 响应中没有工具调用
2025-06-08 11:26:22,175 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:26:22,219 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:26:22,237 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:26:23,398 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:26:23,574 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:26:24,012 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:26:24,373 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:26:24,386 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi4\logs\gongdi_api.log
2025-06-08 11:26:25,067 - asyncio - DEBUG - Using selector: SelectSelector
2025-06-08 11:26:32,005 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '有什么风险吗？', 'tools': [{}]}
2025-06-08 11:26:32,006 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:26:32,007 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: 有什么风险吗？
2025-06-08 11:26:32,008 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:26:32,009 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '有什么风险吗？'}]
2025-06-08 11:26:32,009 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:26:32,011 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:26:32,012 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:26:32,013 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 11:26:32,151 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '有什么风险吗？'}]}}
2025-06-08 11:26:32,161 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 11:26:34,683 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 11:26:34,686 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '您的问题比较宽泛，风险可能涉及很多方面，如健康风险、金融风险、技术风险等。如果您能提供更具体的情境或者领域，我可以为您提供更有针对性的信息和建议。'}}]}, 'usage': {'total_tokens': 266, 'output_tokens': 41, 'input_tokens': 225, 'prompt_tokens_details': {'cached_tokens': 128}}, 'request_id': '2d47e3cb-54e0-982e-9011-35183e918905'}
2025-06-08 11:26:34,692 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 11:26:34,693 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=2d47e3cb-54e0-982e-9011-35183e918905
2025-06-08 11:26:34,694 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '2d47e3cb-54e0-982e-9011-35183e918905', 'choices': [{'message': Message({'role': 'assistant', 'content': '您的问题比较宽泛，风险可能涉及很多方面，如健康风险、金融风险、技术风险等。如果您能提供更具体的情境或者领域，我可以为您提供更有针对性的信息和建议。'})}], 'usage': {}}
2025-06-08 11:26:34,695 - gongdi-api - DEBUG - 响应中没有工具调用
2025-06-08 11:33:38,961 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 11:33:38,995 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 11:33:41,641 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 11:33:41,645 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 11:33:42,542 - asyncio - DEBUG - Using selector: SelectSelector
2025-06-08 11:34:20,530 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '北京时间', 'tools': [{}]}
2025-06-08 11:34:20,530 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:34:20,532 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: 北京时间
2025-06-08 11:34:20,532 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:34:20,533 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '北京时间'}]
2025-06-08 11:34:20,533 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:34:20,535 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 11:34:20,536 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:34:20,536 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 11:34:20,608 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '北京时间'}]}}
2025-06-08 11:34:20,612 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 11:34:22,427 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 11:34:22,429 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'tool_calls', 'message': {'role': 'assistant', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_d9a6bc21f22c47a49b0b59', 'type': 'function'}], 'content': ''}}]}, 'usage': {'total_tokens': 235, 'output_tokens': 13, 'input_tokens': 222, 'prompt_tokens_details': {'cached_tokens': 128}}, 'request_id': '8036ba76-d892-951c-9dcc-9a51ff64b003'}
2025-06-08 11:34:22,432 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 11:34:22,433 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=8036ba76-d892-951c-9dcc-9a51ff64b003
2025-06-08 11:34:22,434 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '8036ba76-d892-951c-9dcc-9a51ff64b003', 'choices': [{'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_d9a6bc21f22c47a49b0b59', 'type': 'function'}]})}], 'usage': {}}
2025-06-08 11:34:22,436 - gongdi-api - DEBUG - 工具调用信息: {'id': 'call_d9a6bc21f22c47a49b0b59', 'function_name': 'get_current_time', 'arguments': {}}
2025-06-08 11:34:22,437 - gongdi-api - DEBUG - 执行函数: get_current_time, 参数: {}
2025-06-08 11:34:22,438 - gongdi-api - DEBUG - 函数执行结果: {'datetime': '2025-06-08 11:34:22', 'date': '2025-06-08', 'time': '11:34:22', 'weekday': 'Sunday'}
2025-06-08 11:34:22,438 - gongdi-api - DEBUG - 将函数调用结果返回给模型处理
2025-06-08 11:34:22,439 - gongdi-api - DEBUG - 发送给模型的完整消息: [{"role": "user", "content": "北京时间"}, {"role": "assistant", "content": "", "tool_calls": [{"function": {"name": "get_current_time", "arguments": "{}"}, "index": 0, "id": "call_d9a6bc21f22c47a49b0b59", "type": "function"}]}, {"tool_call_id": "call_d9a6bc21f22c47a49b0b59", "role": "tool", "content": "{\"datetime\": \"2025-06-08 11:34:22\", \"date\": \"2025-06-08\", \"time\": \"11:34:22\", \"weekday\": \"Sunday\"}"}]
2025-06-08 11:34:22,440 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 11:34:22,441 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '北京时间'}, {'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_d9a6bc21f22c47a49b0b59', 'type': 'function'}]}, {'tool_call_id': 'call_d9a6bc21f22c47a49b0b59', 'role': 'tool', 'content': '{"datetime": "2025-06-08 11:34:22", "date": "2025-06-08", "time": "11:34:22", "weekday": "Sunday"}'}]}}
2025-06-08 11:34:22,446 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 11:34:25,896 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 11:34:25,898 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': 'The given JSON data provides the following information about the date and time in Beijing Time:\n\n- **datetime**: `2025-06-08 11:34:22` (full timestamp)\n- **date**: `2025-06-08` (only the date)\n- **time**: `11:34:22` (only the time)\n- **weekday**: `Sunday` (the day of the week)\n\nThis indicates that the specific moment is Sunday, June 8, 2025, at 11:34:22 in the morning, according to Beijing Time.'}}]}, 'usage': {'total_tokens': 217, 'output_tokens': 138, 'input_tokens': 79, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '0a16dade-2915-9690-9330-9b6fe76e6362'}
2025-06-08 11:34:25,904 - gongdi-api - DEBUG - 模型最终响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '0a16dade-2915-9690-9330-9b6fe76e6362', 'choices': [{'message': {'content': 'The given JSON data provides the following information about the date and time in Beijing Time:\n\n- **datetime**: `2025-06-08 11:34:22` (full timestamp)\n- **date**: `2025-06-08` (only the date)\n- **time**: `11:34:22` (only the time)\n- **weekday**: `Sunday` (the day of the week)\n\nThis indicates that the specific moment is Sunday, June 8, 2025, at 11:34:22 in the morning, according to Beijing Time.', 'role': 'assistant'}}], 'usage': {}}
2025-06-08 11:34:25,906 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '8036ba76-d892-951c-9dcc-9a51ff64b003', 'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_d9a6bc21f22c47a49b0b59', 'type': 'function'}]}), 'tool_calls': [{'id': 'call_d9a6bc21f22c47a49b0b59', 'function_name': 'get_current_time', 'arguments': {}}], 'executed_results': [{'id': 'call_d9a6bc21f22c47a49b0b59', 'function_name': 'get_current_time', 'success': True, 'result': {'datetime': '2025-06-08 11:34:22', 'date': '2025-06-08', 'time': '11:34:22', 'weekday': 'Sunday'}}], 'final_answer': 'The given JSON data provides the following information about the date and time in Beijing Time:\n\n- **datetime**: `2025-06-08 11:34:22` (full timestamp)\n- **date**: `2025-06-08` (only the date)\n- **time**: `11:34:22` (only the time)\n- **weekday**: `Sunday` (the day of the week)\n\nThis indicates that the specific moment is Sunday, June 8, 2025, at 11:34:22 in the morning, according to Beijing Time.'}
2025-06-08 20:07:46,704 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:07:46,732 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:07:52,592 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:07:52,597 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:07:52,710 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:07:53,071 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:07:55,096 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:07:55,390 - asyncio - DEBUG - Using selector: SelectSelector
2025-06-08 20:07:55,457 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:07:56,081 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:08:26,116 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '几点？', 'tools': [{}]}
2025-06-08 20:08:26,117 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 20:08:26,118 - gongdi-api - DEBUG - 调用DashscopeClient处理请求，query: 几点？
2025-06-08 20:08:26,118 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 20:08:26,119 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '几点？'}]
2025-06-08 20:08:26,119 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 20:08:26,120 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 20:08:26,121 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 20:08:26,121 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 20:08:26,190 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '几点？'}]}}
2025-06-08 20:08:26,194 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 20:08:27,977 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 20:08:27,981 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'tool_calls', 'message': {'role': 'assistant', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_b4cbe6d7f1444b4e8ed8f5', 'type': 'function'}], 'content': ''}}]}, 'usage': {'total_tokens': 236, 'output_tokens': 13, 'input_tokens': 223, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '783154a4-840c-972e-8291-5b3b7877835d'}
2025-06-08 20:08:27,984 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 20:08:27,985 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=783154a4-840c-972e-8291-5b3b7877835d
2025-06-08 20:08:27,986 - gongdi-api - DEBUG - API响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '783154a4-840c-972e-8291-5b3b7877835d', 'choices': [{'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_b4cbe6d7f1444b4e8ed8f5', 'type': 'function'}]})}], 'usage': {}}
2025-06-08 20:08:27,988 - gongdi-api - DEBUG - 工具调用信息: {'id': 'call_b4cbe6d7f1444b4e8ed8f5', 'function_name': 'get_current_time', 'arguments': {}}
2025-06-08 20:08:27,989 - gongdi-api - DEBUG - 执行函数: get_current_time, 参数: {}
2025-06-08 20:08:27,990 - gongdi-api - DEBUG - 函数执行结果: {'datetime': '2025-06-08 20:08:27', 'date': '2025-06-08', 'time': '20:08:27', 'weekday': 'Sunday'}
2025-06-08 20:08:27,991 - gongdi-api - DEBUG - 将函数调用结果返回给模型处理
2025-06-08 20:08:27,992 - gongdi-api - DEBUG - 发送给模型的完整消息: [{"role": "user", "content": "几点？"}, {"role": "assistant", "content": "", "tool_calls": [{"function": {"name": "get_current_time", "arguments": "{}"}, "index": 0, "id": "call_b4cbe6d7f1444b4e8ed8f5", "type": "function"}]}, {"tool_call_id": "call_b4cbe6d7f1444b4e8ed8f5", "role": "tool", "content": "{\"datetime\": \"2025-06-08 20:08:27\", \"date\": \"2025-06-08\", \"time\": \"20:08:27\", \"weekday\": \"Sunday\"}"}]
2025-06-08 20:08:27,993 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 20:08:27,995 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '几点？'}, {'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_b4cbe6d7f1444b4e8ed8f5', 'type': 'function'}]}, {'tool_call_id': 'call_b4cbe6d7f1444b4e8ed8f5', 'role': 'tool', 'content': '{"datetime": "2025-06-08 20:08:27", "date": "2025-06-08", "time": "20:08:27", "weekday": "Sunday"}'}]}}
2025-06-08 20:08:28,001 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 20:08:29,296 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 20:08:29,298 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '现在的时间是 20:08:27。'}}]}, 'usage': {'total_tokens': 92, 'output_tokens': 13, 'input_tokens': 79, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '35576bab-c53d-93c0-9614-6e24a4f6392d'}
2025-06-08 20:08:29,299 - gongdi-api - DEBUG - 模型最终响应: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '35576bab-c53d-93c0-9614-6e24a4f6392d', 'choices': [{'message': {'content': '现在的时间是 20:08:27。', 'role': 'assistant'}}], 'usage': {}}
2025-06-08 20:08:29,300 - gongdi-api - DEBUG - 最终返回结果: {'status_code': <HTTPStatus.OK: 200>, 'request_id': '783154a4-840c-972e-8291-5b3b7877835d', 'message': Message({'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_b4cbe6d7f1444b4e8ed8f5', 'type': 'function'}]}), 'tool_calls': [{'id': 'call_b4cbe6d7f1444b4e8ed8f5', 'function_name': 'get_current_time', 'arguments': {}}], 'executed_results': [{'id': 'call_b4cbe6d7f1444b4e8ed8f5', 'function_name': 'get_current_time', 'success': True, 'result': {'datetime': '2025-06-08 20:08:27', 'date': '2025-06-08', 'time': '20:08:27', 'weekday': 'Sunday'}}], 'final_answer': '现在的时间是 20:08:27。'}
2025-06-08 20:09:30,528 - watchfiles.main - DEBUG - 5 changes detected: {(<Change.added: 1>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\api'), (<Change.added: 1>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\models'), (<Change.added: 1>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\utils'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app'), (<Change.added: 1>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\api\\routes')}
2025-06-08 20:09:30,983 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app')}
2025-06-08 20:09:36,662 - watchfiles.main - DEBUG - 1 change detected: {(<Change.added: 1>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\core\\config.py')}
2025-06-08 20:09:37,699 - watchfiles.main - DEBUG - 2 changes detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\core'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:38,123 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:39,174 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:39,551 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:39,916 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:40,185 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:09:40,191 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:09:40,284 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:41,146 - watchfiles.main - DEBUG - 2 changes detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\core\\config.py'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:43,357 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:44,462 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:09:44,468 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:09:44,523 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:44,887 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:45,246 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:45,613 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:45,967 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:46,575 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:46,930 - watchfiles.main - DEBUG - 2 changes detected: {(<Change.added: 1>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\core\\logging.py'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:47,638 - watchfiles.main - DEBUG - 2 changes detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\core'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:49,020 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:09:49,026 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:09:49,123 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:49,536 - watchfiles.main - DEBUG - 2 changes detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\core\\logging.py'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:51,223 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:52,635 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:09:52,641 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:09:52,695 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:53,066 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:53,437 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:53,794 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:54,166 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:54,929 - watchfiles.main - DEBUG - 3 changes detected: {(<Change.added: 1>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\models\\schemas.py'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\models'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:55,532 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:56,838 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:09:56,844 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:09:56,906 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:57,270 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:57,632 - watchfiles.main - DEBUG - 2 changes detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\models\\schemas.py'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:09:59,160 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:00,086 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:10:00,091 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:10:00,175 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:00,538 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:00,891 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:01,249 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:01,605 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:01,963 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:02,294 - asyncio - DEBUG - Using selector: SelectSelector
2025-06-08 20:10:02,372 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:02,724 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:03,083 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:03,439 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:03,797 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:04,152 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:04,506 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:04,861 - watchfiles.main - DEBUG - 3 changes detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\utils'), (<Change.added: 1>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\utils\\tools.py'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:05,526 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:05,884 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:06,644 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:06,686 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:10:06,690 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:10:07,008 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:07,367 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:07,725 - watchfiles.main - DEBUG - 2 changes detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\utils\\tools.py'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:08,656 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:09,013 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:09,368 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:09,549 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:10:09,553 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:10:09,724 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:10,079 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:10,535 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:10,898 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:11,254 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:11,611 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:11,684 - asyncio - DEBUG - Using selector: SelectSelector
2025-06-08 20:10:11,968 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:12,478 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:12,838 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:13,194 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:13,551 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:13,906 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:14,618 - watchfiles.main - DEBUG - 3 changes detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\api\\routes'), (<Change.added: 1>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\api\\routes\\chat.py'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:15,334 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:15,687 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:16,044 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:16,639 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:10:16,648 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:10:16,706 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:17,068 - watchfiles.main - DEBUG - 2 changes detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\api\\routes\\chat.py'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:18,796 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:19,150 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:19,505 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:19,863 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:19,908 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:10:19,912 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:10:20,218 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:20,626 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:20,980 - watchfiles.main - DEBUG - 2 changes detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\.git\\FETCH_HEAD'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:21,334 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:21,691 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:22,047 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:22,219 - asyncio - DEBUG - Using selector: SelectSelector
2025-06-08 20:10:22,404 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:22,761 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:23,116 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:23,522 - watchfiles.main - DEBUG - 2 changes detected: {(<Change.added: 1>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\api\\routes\\debug.py'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:24,261 - watchfiles.main - DEBUG - 2 changes detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\api\\routes'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:24,831 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:25,183 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:25,474 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:10:25,480 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:10:25,536 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:25,892 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:26,713 - watchfiles.main - DEBUG - 2 changes detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\api\\routes\\debug.py'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:27,451 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:28,413 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:10:28,418 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:10:28,514 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:28,869 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:29,224 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:29,581 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:29,936 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:30,293 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:30,687 - asyncio - DEBUG - Using selector: SelectSelector
2025-06-08 20:10:30,750 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:31,113 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:31,468 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:31,831 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:32,184 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:32,592 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:32,956 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:33,311 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:33,668 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:34,025 - watchfiles.main - DEBUG - 2 changes detected: {(<Change.added: 1>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\api\\routes\\tools.py'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:34,687 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:35,040 - watchfiles.main - DEBUG - 2 changes detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\api\\routes'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:35,393 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:35,747 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:35,807 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:10:35,812 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:10:36,102 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:36,810 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:37,167 - watchfiles.main - DEBUG - 2 changes detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\api\\routes\\tools.py'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:37,875 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:38,798 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:10:38,803 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:10:38,888 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:39,252 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:39,606 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:39,962 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:40,723 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:41,040 - asyncio - DEBUG - Using selector: SelectSelector
2025-06-08 20:10:41,088 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:41,442 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:41,798 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:42,150 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:42,705 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:43,062 - watchfiles.main - DEBUG - 1 change detected: {(<Change.added: 1>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\main.py')}
2025-06-08 20:10:43,818 - watchfiles.main - DEBUG - 2 changes detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:44,181 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:44,797 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:45,044 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:10:45,050 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:10:45,157 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:45,513 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:45,872 - watchfiles.main - DEBUG - 2 changes detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\main.py'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:46,998 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:47,960 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:10:47,965 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:10:48,062 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:48,826 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:49,181 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:49,537 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:49,890 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:50,248 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:50,497 - asyncio - DEBUG - Using selector: SelectSelector
2025-06-08 20:10:50,602 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:50,955 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:51,312 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:51,668 - watchfiles.main - DEBUG - 2 changes detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\__init__.py'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:52,332 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:52,688 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:53,045 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:53,265 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:10:53,275 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:10:53,403 - watchfiles.main - DEBUG - 6 changes detected: {(<Change.deleted: 3>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\__pycache__\\__init__.cpython-313.pyc.2200480681184'), (<Change.added: 1>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\__pycache__\\__init__.cpython-313.pyc.2200480681184'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\__pycache__'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log'), (<Change.deleted: 3>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\__pycache__\\__init__.cpython-313.pyc'), (<Change.added: 1>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\__pycache__\\__init__.cpython-313.pyc')}
2025-06-08 20:10:53,757 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:54,113 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:54,721 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:55,074 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:55,432 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:55,571 - asyncio - DEBUG - Using selector: SelectSelector
2025-06-08 20:10:55,786 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:56,141 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:56,746 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:57,099 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:57,453 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:57,811 - watchfiles.main - DEBUG - 2 changes detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\core\\__init__.py'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:58,479 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:58,834 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:59,191 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:10:59,422 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:10:59,426 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:10:59,548 - watchfiles.main - DEBUG - 6 changes detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log'), (<Change.deleted: 3>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\core\\__pycache__\\__init__.cpython-313.pyc'), (<Change.deleted: 3>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\core\\__pycache__\\__init__.cpython-313.pyc.2013776615728'), (<Change.added: 1>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\core\\__pycache__\\__init__.cpython-313.pyc'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\core\\__pycache__'), (<Change.added: 1>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\core\\__pycache__\\__init__.cpython-313.pyc.2013776615728')}
2025-06-08 20:10:59,903 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:00,257 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:00,766 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:01,124 - watchfiles.main - DEBUG - 3 changes detected: {(<Change.added: 1>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\api\\__init__.py'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\api'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:01,687 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:03,092 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:11:03,097 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:11:03,178 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:03,545 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:03,911 - watchfiles.main - DEBUG - 2 changes detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\api\\__init__.py'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:05,280 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:06,191 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:11:06,196 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:11:06,291 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:06,754 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:07,115 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:07,472 - watchfiles.main - DEBUG - 3 changes detected: {(<Change.added: 1>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\api\\routes\\__init__.py'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\api\\routes'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:08,137 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:09,569 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:11:09,574 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:11:09,659 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:10,013 - watchfiles.main - DEBUG - 2 changes detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\api\\routes\\__init__.py'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:11,624 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:12,589 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:11:12,595 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:11:12,689 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:13,046 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:13,405 - watchfiles.main - DEBUG - 2 changes detected: {(<Change.added: 1>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\models\\__init__.py'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:14,746 - watchfiles.main - DEBUG - 2 changes detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\models'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:15,188 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:15,562 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:15,929 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:16,292 - watchfiles.main - DEBUG - 2 changes detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\app\\models\\__init__.py'), (<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:16,974 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:17,341 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:17,696 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:18,048 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:11:18,049 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:18,053 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:11:18,403 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:11:19,059 - watchfiles.main - DEBUG - 1 change detected: {(<Change.modified: 2>, 'C:\\code\\gongdi\\gongdi-fastapi\\logs\\gongdi_api.log')}
2025-06-08 20:15:02,263 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:15:06,817 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:15:06,827 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:15:06,853 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:15:06,859 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:16:05,365 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 20:16:05,452 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'system', 'content': '你是一个建筑工地智能助手，会简洁明了地回答问题。'}, {'role': 'user', 'content': '你叫什么'}]}}
2025-06-08 20:16:05,456 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 20:16:08,044 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 20:16:08,047 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '我是建筑工地智能助手，你可以叫我智建。有什么建筑相关的问题需要我帮忙解答吗？'}}]}, 'usage': {'total_tokens': 52, 'output_tokens': 21, 'input_tokens': 31, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': 'f76634ee-c182-99fa-b654-04047c26cf9a'}
2025-06-08 20:16:36,982 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '几点？', 'tools': [{}]}
2025-06-08 20:16:36,983 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 20:16:36,983 - gongdi-api - ERROR - 函数调用失败: DashscopeClient.function_call() got an unexpected keyword argument 'query'
2025-06-08 20:20:23,800 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:20:24,519 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:20:24,525 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:20:24,540 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:20:24,543 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:20:41,709 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '几点？', 'tools': [{}]}
2025-06-08 20:20:41,710 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 20:20:41,711 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '几点？'}]
2025-06-08 20:20:41,711 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{}]
2025-06-08 20:20:41,712 - gongdi-api.dashscope - DEBUG - 替换空工具为默认工具: {'type': 'function', 'function': {'name': 'default_tool_0', 'description': '默认工具'}}
2025-06-08 20:20:41,713 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'default_tool_0', 'description': '默认工具'}}]
2025-06-08 20:20:41,713 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 20:20:41,714 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 20:20:41,779 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'default_tool_0', 'description': '默认工具'}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '几点？'}]}}
2025-06-08 20:20:41,784 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 20:20:46,867 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 20:20:46,869 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '几点什么？你可以提供更具体的信息或者问句，这样我才能更好地帮助你。'}}]}, 'usage': {'total_tokens': 158, 'output_tokens': 19, 'input_tokens': 139, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '0538f3f0-db49-907c-bc5d-b46a954d7798'}
2025-06-08 20:20:46,872 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 20:20:46,872 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=0538f3f0-db49-907c-bc5d-b46a954d7798
2025-06-08 20:21:20,761 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:21:21,579 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:21:21,586 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:21:21,606 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:21:21,610 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:21:57,833 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:21:58,598 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:21:58,604 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:21:58,617 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:21:58,621 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:22:06,934 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '几点？', 'tools': [{}]}
2025-06-08 20:22:06,935 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 20:22:06,935 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '几点？'}]
2025-06-08 20:22:06,936 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{}]
2025-06-08 20:22:06,936 - gongdi-api.dashscope - DEBUG - 替换空工具为默认工具: {'type': 'function', 'function': {'name': 'default_tool_0', 'description': '默认工具'}}
2025-06-08 20:22:06,937 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'default_tool_0', 'description': '默认工具'}}]
2025-06-08 20:22:06,938 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 20:22:06,938 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 20:22:07,039 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'default_tool_0', 'description': '默认工具'}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '几点？'}]}}
2025-06-08 20:22:07,046 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 20:22:09,577 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 20:22:09,579 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '几点什么？你可以提供更具体的信息或者问句，这样我才能更好地帮助你。'}}]}, 'usage': {'total_tokens': 158, 'output_tokens': 19, 'input_tokens': 139, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': 'b3b67cce-770f-9531-9ba9-33767ffabe92'}
2025-06-08 20:22:09,583 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 20:22:09,583 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=b3b67cce-770f-9531-9ba9-33767ffabe92
2025-06-08 20:22:09,584 - gongdi-api - ERROR - 函数调用失败: '__pydantic_validator__'
2025-06-08 20:23:19,214 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:23:20,057 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:23:20,064 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:23:20,073 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:23:20,077 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:23:42,656 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '几点？', 'tools': [{}]}
2025-06-08 20:23:42,657 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 20:23:42,658 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '几点？'}]
2025-06-08 20:23:42,658 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{}]
2025-06-08 20:23:42,659 - gongdi-api.dashscope - DEBUG - 替换空工具为默认工具: {'type': 'function', 'function': {'name': 'default_tool_0', 'description': '默认工具'}}
2025-06-08 20:23:42,659 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'default_tool_0', 'description': '默认工具'}}]
2025-06-08 20:23:42,660 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 20:23:42,660 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 20:23:42,736 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'default_tool_0', 'description': '默认工具'}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '几点？'}]}}
2025-06-08 20:23:42,741 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 20:23:45,604 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 20:23:45,606 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '几点什么？你可以提供更具体的信息或者问句，这样我才能更好地帮助你。'}}]}, 'usage': {'total_tokens': 158, 'output_tokens': 19, 'input_tokens': 139, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': 'a7cf8d9f-d160-9362-b871-939c646e092c'}
2025-06-08 20:23:45,609 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 20:23:45,609 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=a7cf8d9f-d160-9362-b871-939c646e092c
2025-06-08 20:24:12,795 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:24:13,517 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:24:13,524 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:24:13,538 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:24:13,542 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:29:30,459 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:29:31,259 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:29:31,265 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:29:31,285 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:29:31,291 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:30:34,114 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:30:34,809 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:30:34,814 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:30:34,831 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:30:34,837 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:30:36,152 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '几点？', 'tools': [{}]}
2025-06-08 20:30:36,153 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 20:30:36,154 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '几点？'}]
2025-06-08 20:30:36,155 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{}]
2025-06-08 20:30:36,155 - gongdi-api.dashscope - DEBUG - 替换空工具为默认工具: {'type': 'function', 'function': {'name': 'default_tool_0', 'description': '默认工具'}}
2025-06-08 20:30:36,156 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'default_tool_0', 'description': '默认工具'}}]
2025-06-08 20:30:36,156 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 20:30:36,157 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 20:30:36,215 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'default_tool_0', 'description': '默认工具'}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '几点？'}]}}
2025-06-08 20:30:36,220 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 20:30:39,971 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 20:30:39,972 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '几点什么？你可以提供更具体的信息或者问句，这样我才能更好地帮助你。'}}]}, 'usage': {'total_tokens': 158, 'output_tokens': 19, 'input_tokens': 139, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '80168fce-f6d1-95cc-91fb-852f9ace26b3'}
2025-06-08 20:30:39,975 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 20:30:39,975 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=80168fce-f6d1-95cc-91fb-852f9ace26b3
2025-06-08 20:31:10,790 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '几点了？', 'tools': [{}]}
2025-06-08 20:31:10,791 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 20:31:10,791 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '几点了？'}]
2025-06-08 20:31:10,792 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{}]
2025-06-08 20:31:10,793 - gongdi-api.dashscope - DEBUG - 替换空工具为默认工具: {'type': 'function', 'function': {'name': 'default_tool_0', 'description': '默认工具'}}
2025-06-08 20:31:10,794 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'default_tool_0', 'description': '默认工具'}}]
2025-06-08 20:31:10,795 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 20:31:10,796 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 20:31:10,797 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'default_tool_0', 'description': '默认工具'}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '几点了？'}]}}
2025-06-08 20:31:10,802 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 20:31:14,182 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 20:31:14,183 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '抱歉，我无法提供当前时间。你可以查看你的设备上的时钟来获取当前时间。有什么我可以帮助你的吗？'}}]}, 'usage': {'total_tokens': 166, 'output_tokens': 26, 'input_tokens': 140, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '911eade2-2603-97b8-90e4-ab8e16b82c0f'}
2025-06-08 20:31:14,186 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 20:31:14,186 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=911eade2-2603-97b8-90e4-ab8e16b82c0f
2025-06-08 20:33:56,201 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '几点了？', 'tools': [{}]}
2025-06-08 20:33:56,202 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 20:33:56,203 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '几点了？'}]
2025-06-08 20:33:56,203 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{}]
2025-06-08 20:33:56,204 - gongdi-api.dashscope - DEBUG - 替换空工具为默认工具: {'type': 'function', 'function': {'name': 'default_tool_0', 'description': '默认工具'}}
2025-06-08 20:33:56,204 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'default_tool_0', 'description': '默认工具'}}]
2025-06-08 20:33:56,205 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 20:33:56,205 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 20:33:56,206 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'default_tool_0', 'description': '默认工具'}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '几点了？'}]}}
2025-06-08 20:33:56,210 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 20:33:59,773 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 20:33:59,774 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '抱歉，我无法提供当前时间。你可以查看你的设备上的时钟来获取当前时间。有什么我可以帮助你的吗？'}}]}, 'usage': {'total_tokens': 166, 'output_tokens': 26, 'input_tokens': 140, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': 'fef74fe2-5eff-9fb3-a4f5-42a94f6eee13'}
2025-06-08 20:33:59,778 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 20:33:59,779 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=fef74fe2-5eff-9fb3-a4f5-42a94f6eee13
2025-06-08 20:42:18,512 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:42:19,207 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:42:19,212 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:42:19,227 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:42:19,231 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:42:22,183 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '几点了？', 'tools': [{}]}
2025-06-08 20:42:22,183 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 20:42:22,184 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '几点了？'}]
2025-06-08 20:42:22,184 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{}]
2025-06-08 20:42:22,184 - gongdi-api.dashscope - DEBUG - 替换空工具为默认工具: {'type': 'function', 'function': {'name': 'default_tool_0', 'description': '默认工具'}}
2025-06-08 20:42:22,185 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'default_tool_0', 'description': '默认工具'}}]
2025-06-08 20:42:22,185 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 20:42:22,186 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 20:42:22,252 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'default_tool_0', 'description': '默认工具'}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '几点了？'}]}}
2025-06-08 20:42:22,257 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 20:42:25,456 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 20:42:25,457 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '抱歉，我无法提供当前时间。你可以查看你的设备上的时钟来获取当前时间。有什么我可以帮助你的吗？'}}]}, 'usage': {'total_tokens': 166, 'output_tokens': 26, 'input_tokens': 140, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': 'd6e6f9e6-2a83-9579-ae55-c223a335d136'}
2025-06-08 20:42:25,460 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 20:42:25,460 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=d6e6f9e6-2a83-9579-ae55-c223a335d136
2025-06-08 20:47:03,534 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:47:04,314 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:47:04,319 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:47:04,339 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:47:04,344 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:47:22,208 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:47:22,933 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:47:22,940 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:47:37,110 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:47:37,892 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:47:37,897 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:47:37,911 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:47:37,915 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 20:47:41,778 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '几点了？', 'tools': [{}]}
2025-06-08 20:47:41,779 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 20:47:41,780 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 20:47:41,781 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '几点了？'}]
2025-06-08 20:47:41,782 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 20:47:41,783 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 20:47:41,784 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 20:47:41,784 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 20:47:41,872 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '几点了？'}]}}
2025-06-08 20:47:41,878 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 20:47:44,034 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 20:47:44,035 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'tool_calls', 'message': {'role': 'assistant', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_cb4b6d5b253040a6b8140e', 'type': 'function'}], 'content': ''}}]}, 'usage': {'total_tokens': 237, 'output_tokens': 13, 'input_tokens': 224, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': 'a40475db-3354-9d6b-8fd9-de07f01bf86f'}
2025-06-08 20:47:44,040 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 20:47:44,040 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=a40475db-3354-9d6b-8fd9-de07f01bf86f
2025-06-08 20:47:44,041 - gongdi-api - DEBUG - 执行函数: get_current_time, 参数: {}
2025-06-08 20:47:44,042 - gongdi-api - DEBUG - 函数执行结果: {'datetime': '2025-06-08 20:47:44', 'date': '2025-06-08', 'time': '20:47:44', 'weekday': 'Sunday'}
2025-06-08 20:47:44,042 - gongdi-api - DEBUG - 发送给模型的完整消息: [{"role": "user", "content": "几点了？"}, {"role": "assistant", "content": "", "tool_calls": [{"function": {"name": "get_current_time", "arguments": "{}"}, "index": 0, "id": "call_cb4b6d5b253040a6b8140e", "type": "function"}]}, {"tool_call_id": "call_cb4b6d5b253040a6b8140e", "role": "tool", "content": "{\"datetime\": \"2025-06-08 20:47:44\", \"date\": \"2025-06-08\", \"time\": \"20:47:44\", \"weekday\": \"Sunday\"}"}]
2025-06-08 20:47:44,043 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 20:47:44,044 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '几点了？'}, {'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_cb4b6d5b253040a6b8140e', 'type': 'function'}]}, {'tool_call_id': 'call_cb4b6d5b253040a6b8140e', 'role': 'tool', 'content': '{"datetime": "2025-06-08 20:47:44", "date": "2025-06-08", "time": "20:47:44", "weekday": "Sunday"}'}]}}
2025-06-08 20:47:44,048 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 20:47:46,954 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 20:47:46,956 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '现在是20:47。'}}]}, 'usage': {'total_tokens': 88, 'output_tokens': 8, 'input_tokens': 80, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': 'a6ea5f79-6214-920d-b6cb-2e458a421bab'}
2025-06-08 20:47:46,959 - gongdi-api - DEBUG - 模型最终响应: {'status_code': {'phrase': 'OK', 'description': 'Request fulfilled, document follows'}, 'request_id': 'a6ea5f79-6214-920d-b6cb-2e458a421bab', 'choices': [{'message': {'content': '现在是20:47。', 'role': 'assistant'}}], 'usage': {}}
2025-06-08 20:49:47,793 - gongdi-api - DEBUG - 接收到函数调用请求: {'query': '日本现在几点了？', 'tools': [{}]}
2025-06-08 20:49:47,794 - gongdi-api - DEBUG - 使用默认工具: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 20:49:47,795 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 20:49:47,795 - gongdi-api.dashscope - DEBUG - 接收function_call请求: messages=[{'role': 'user', 'content': '日本现在几点了？'}]
2025-06-08 20:49:47,796 - gongdi-api.dashscope - DEBUG - 原始工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 20:49:47,797 - gongdi-api.dashscope - DEBUG - 格式化后的工具列表: [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}]
2025-06-08 20:49:47,798 - gongdi-api.dashscope - DEBUG - 调用DashScope API参数: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 20:49:47,798 - gongdi-api.dashscope - DEBUG - 开始调用DashScope API...
2025-06-08 20:49:47,799 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'tools': [{'type': 'function', 'function': {'name': 'get_current_time', 'description': '当你想知道现在的时间时非常有用。', 'parameters': {}}}, {'type': 'function', 'function': {'name': 'get_current_weather', 'description': '当你想查询指定城市的天气时非常有用。', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string', 'description': '城市或县区，比如北京市、杭州市、余杭区等。'}}, 'required': ['location']}}}], 'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '日本现在几点了？'}]}}
2025-06-08 20:49:47,802 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 20:49:50,607 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 20:49:50,608 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'tool_calls', 'message': {'role': 'assistant', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_bc38a3d780c2499ab24c9b', 'type': 'function'}], 'content': ''}}]}, 'usage': {'total_tokens': 239, 'output_tokens': 13, 'input_tokens': 226, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '841c1f2c-142b-989d-91d1-4369277cd9a4'}
2025-06-08 20:49:50,611 - gongdi-api.dashscope - DEBUG - DashScope API响应状态码: 200
2025-06-08 20:49:50,611 - gongdi-api.dashscope - DEBUG - 成功处理响应: request_id=841c1f2c-142b-989d-91d1-4369277cd9a4
2025-06-08 20:49:50,612 - gongdi-api - DEBUG - 执行函数: get_current_time, 参数: {}
2025-06-08 20:49:50,612 - gongdi-api - DEBUG - 函数执行结果: {'datetime': '2025-06-08 20:49:50', 'date': '2025-06-08', 'time': '20:49:50', 'weekday': 'Sunday'}
2025-06-08 20:49:50,613 - gongdi-api - DEBUG - 发送给模型的完整消息: [{"role": "user", "content": "日本现在几点了？"}, {"role": "assistant", "content": "", "tool_calls": [{"function": {"name": "get_current_time", "arguments": "{}"}, "index": 0, "id": "call_bc38a3d780c2499ab24c9b", "type": "function"}]}, {"tool_call_id": "call_bc38a3d780c2499ab24c9b", "role": "tool", "content": "{\"datetime\": \"2025-06-08 20:49:50\", \"date\": \"2025-06-08\", \"time\": \"20:49:50\", \"weekday\": \"Sunday\"}"}]
2025-06-08 20:49:50,614 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 20:49:50,615 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'user', 'content': '日本现在几点了？'}, {'role': 'assistant', 'content': '', 'tool_calls': [{'function': {'name': 'get_current_time', 'arguments': '{}'}, 'index': 0, 'id': 'call_bc38a3d780c2499ab24c9b', 'type': 'function'}]}, {'tool_call_id': 'call_bc38a3d780c2499ab24c9b', 'role': 'tool', 'content': '{"datetime": "2025-06-08 20:49:50", "date": "2025-06-08", "time": "20:49:50", "weekday": "Sunday"}'}]}}
2025-06-08 20:49:50,618 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 20:49:53,984 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 20:49:53,986 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '根据提供的信息，现在是 **2025年6月8日，当地时间20:49:50**。也就是说，日本当前的时间是 **晚上8点49分50秒**。'}}]}, 'usage': {'total_tokens': 128, 'output_tokens': 46, 'input_tokens': 82, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '35035a92-6baf-9410-9408-160dfd8221bd'}
2025-06-08 20:49:53,990 - gongdi-api - DEBUG - 模型最终响应: {'status_code': {'phrase': 'OK', 'description': 'Request fulfilled, document follows'}, 'request_id': '35035a92-6baf-9410-9408-160dfd8221bd', 'choices': [{'message': {'content': '根据提供的信息，现在是 **2025年6月8日，当地时间20:49:50**。也就是说，日本当前的时间是 **晚上8点49分50秒**。', 'role': 'assistant'}}], 'usage': {}}
2025-06-08 21:16:42,623 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 21:16:46,798 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 21:16:46,949 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'system', 'content': '你是一个建筑工地智能助手'}, {'role': 'user', 'content': '今天天气'}]}}
2025-06-08 21:16:46,954 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 21:16:49,734 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 21:16:49,736 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '根据最新的天气预报，今天工地所在地的天气情况如下：白天晴朗，气温在20到25摄氏度之间，风速较小，属于较为适宜施工的天气。不过建议还是关注实时天气变化，尤其是高空作业和吊装作业时要注意安全。如果需要更详细的天气信息，可以查看当地气象台的最新通知。'}}]}, 'usage': {'total_tokens': 96, 'output_tokens': 75, 'input_tokens': 21, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '2a2757b9-1154-9bbf-a5ce-72e38efa615d'}
2025-06-08 21:17:57,366 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 21:18:20,938 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 21:18:23,805 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 21:18:26,711 - gongdi-api - INFO - 日志文件路径: C:\code\gongdi\gongdi-fastapi\logs\gongdi_api.log
2025-06-08 21:18:48,091 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 21:18:48,179 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'system', 'content': '你是一个建筑工地智能助手'}, {'role': 'user', 'content': '几天天气'}]}}
2025-06-08 21:18:48,186 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 21:18:51,546 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 21:18:51,549 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '我目前无法直接获取实时天气信息。不过，你可以告诉我你所在的具体地点和时间范围（比如未来3天），我可以根据一般情况给你提供建议！例如，如果是雨天，记得提醒施工队注意防雨措施；晴天则要注意防晒和防暑降温。'}}]}, 'usage': {'total_tokens': 82, 'output_tokens': 61, 'input_tokens': 21, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '40e17130-69ab-9efd-8ff9-acdea5111963'}
2025-06-08 21:19:05,632 - gongdi-api.dashscope - DEBUG - DashscopeClient初始化: model=qwen-turbo, temperature=0, max_tokens=2048
2025-06-08 21:19:05,633 - dashscope - DEBUG - Request body: {'model': 'qwen-turbo', 'parameters': {'temperature': 0, 'max_tokens': 2048, 'result_format': 'message'}, 'input': {'messages': [{'role': 'system', 'content': '你是一个建筑工地智能助手'}, {'role': 'user', 'content': '未来三天天气'}]}}
2025-06-08 21:19:05,636 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): dashscope.aliyuncs.com:443
2025-06-08 21:19:09,709 - urllib3.connectionpool - DEBUG - https://dashscope.aliyuncs.com:443 "POST /api/v1/services/aigc/text-generation/generation HTTP/1.1" 200 None
2025-06-08 21:19:09,711 - dashscope - DEBUG - Response: {'output': {'choices': [{'finish_reason': 'stop', 'message': {'role': 'assistant', 'content': '根据最新的气象数据，为您预测未来三天的天气情况：\n\n第一天：多云转晴，气温较低，建议施工时注意保暖，做好防风措施。\n第二天：晴间多云，气温有所回升，适合户外作业，但需关注午后可能出现的短暂阵雨。\n第三天：阴有小雨，建议暂停高空及露天作业，确保人员和材料的安全。\n\n请随时关注实时天气预报，合理安排施工计划。'}}]}, 'usage': {'total_tokens': 114, 'output_tokens': 92, 'input_tokens': 22, 'prompt_tokens_details': {'cached_tokens': 0}}, 'request_id': '5a3c7cec-0abb-9507-80fa-69cfec6d2d81'}
